/**
 * @license
 * pixi.js - v1.4.1
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2014-01-07
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){function o(){return n.Matrix=typeof Float32Array!="undefined"?Float32Array:Array,n.Matrix}var e=this,n=n||{},f,u,i,t;for(n.WEBGL_RENDERER=0,n.CANVAS_RENDERER=1,n.Point=function(n,t){this.x=n||0;this.y=t||0},n.Point.prototype.clone=function(){return new n.Point(this.x,this.y)},n.Point.prototype.constructor=n.Point,n.Rectangle=function(n,t,i,r){this.x=n||0;this.y=t||0;this.width=i||0;this.height=r||0},n.Rectangle.prototype.clone=function(){return new n.Rectangle(this.x,this.y,this.width,this.height)},n.Rectangle.prototype.contains=function(n,t){var i,r;return this.width<=0||this.height<=0?!1:(i=this.x,n>=i&&n<=i+this.width&&(r=this.y,t>=r&&t<=r+this.height))?!0:!1},n.Rectangle.prototype.constructor=n.Rectangle,n.Polygon=function(t){var r,i,u;if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),typeof t[0]=="number"){for(r=[],i=0,u=t.length;i<u;i+=2)r.push(new n.Point(t[i],t[i+1]));t=r}this.points=t},n.Polygon.prototype.clone=function(){for(var i=[],t=0;t<this.points.length;t++)i.push(this.points[t].clone());return new n.Polygon(i)},n.Polygon.prototype.contains=function(n,t){for(var r=!1,i=0,u=this.points.length-1;i<this.points.length;u=i++){var e=this.points[i].x,f=this.points[i].y,s=this.points[u].x,o=this.points[u].y,h=f>t!=o>t&&n<(s-e)*(t-f)/(o-f)+e;h&&(r=!r)}return r},n.Polygon.prototype.constructor=n.Polygon,n.Circle=function(n,t,i){this.x=n||0;this.y=t||0;this.radius=i||0},n.Circle.prototype.clone=function(){return new n.Circle(this.x,this.y,this.radius)},n.Circle.prototype.contains=function(n,t){if(this.radius<=0)return!1;var i=this.x-n,r=this.y-t,u=this.radius*this.radius;return i*=i,r*=r,i+r<=u},n.Circle.prototype.constructor=n.Circle,n.Ellipse=function(n,t,i,r){this.x=n||0;this.y=t||0;this.width=i||0;this.height=r||0},n.Ellipse.prototype.clone=function(){return new n.Ellipse(this.x,this.y,this.width,this.height)},n.Ellipse.prototype.contains=function(n,t){if(this.width<=0||this.height<=0)return!1;var i=(n-this.x)/this.width-.5,r=(t-this.y)/this.height-.5;return i*=i,r*=r,i+r<.25},n.Ellipse.prototype.getBounds=function(){return new n.Rectangle(this.x,this.y,this.width,this.height)},n.Ellipse.prototype.constructor=n.Ellipse,o(),n.mat3={},n.mat3.create=function(){var t=new n.Matrix(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.mat3.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},n.mat4={},n.mat4.create=function(){var t=new n.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.mat3.multiply=function(n,t,i){i||(i=n);var r=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=n[6],c=n[7],l=n[8],a=t[0],v=t[1],y=t[2],p=t[3],w=t[4],b=t[5],k=t[6],d=t[7],g=t[8];return i[0]=a*r+v*e+y*h,i[1]=a*u+v*o+y*c,i[2]=a*f+v*s+y*l,i[3]=p*r+w*e+b*h,i[4]=p*u+w*o+b*c,i[5]=p*f+w*s+b*l,i[6]=k*r+d*e+g*h,i[7]=k*u+d*o+g*c,i[8]=k*f+d*s+g*l,i},n.mat3.clone=function(t){var i=new n.Matrix(9);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},n.mat3.transpose=function(n,t){if(!t||n===t){var i=n[1],r=n[2],u=n[5];return n[1]=n[3],n[2]=n[6],n[3]=i,n[5]=n[7],n[6]=r,n[7]=u,n}return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],t},n.mat3.toMat4=function(t,i){return i||(i=n.mat4.create()),i[15]=1,i[14]=0,i[13]=0,i[12]=0,i[11]=0,i[10]=t[8],i[9]=t[7],i[8]=t[6],i[7]=0,i[6]=t[5],i[5]=t[4],i[4]=t[3],i[3]=0,i[2]=t[2],i[1]=t[1],i[0]=t[0],i},n.mat4.create=function(){var t=new n.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.mat4.transpose=function(n,t){if(!t||n===t){var i=n[1],r=n[2],u=n[3],f=n[6],e=n[7],o=n[11];return n[1]=n[4],n[2]=n[8],n[3]=n[12],n[4]=i,n[6]=n[9],n[7]=n[13],n[8]=r,n[9]=f,n[11]=n[14],n[12]=u,n[13]=e,n[14]=o,n}return t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15],t},n.mat4.multiply=function(n,t,i){i||(i=n);var o=n[0],s=n[1],h=n[2],c=n[3],l=n[4],a=n[5],v=n[6],y=n[7],p=n[8],w=n[9],b=n[10],k=n[11],d=n[12],g=n[13],nt=n[14],tt=n[15],r=t[0],u=t[1],f=t[2],e=t[3];return i[0]=r*o+u*l+f*p+e*d,i[1]=r*s+u*a+f*w+e*g,i[2]=r*h+u*v+f*b+e*nt,i[3]=r*c+u*y+f*k+e*tt,r=t[4],u=t[5],f=t[6],e=t[7],i[4]=r*o+u*l+f*p+e*d,i[5]=r*s+u*a+f*w+e*g,i[6]=r*h+u*v+f*b+e*nt,i[7]=r*c+u*y+f*k+e*tt,r=t[8],u=t[9],f=t[10],e=t[11],i[8]=r*o+u*l+f*p+e*d,i[9]=r*s+u*a+f*w+e*g,i[10]=r*h+u*v+f*b+e*nt,i[11]=r*c+u*y+f*k+e*tt,r=t[12],u=t[13],f=t[14],e=t[15],i[12]=r*o+u*l+f*p+e*d,i[13]=r*s+u*a+f*w+e*g,i[14]=r*h+u*v+f*b+e*nt,i[15]=r*c+u*y+f*k+e*tt,i},n.identityMatrix=n.mat3.create(),n.DisplayObject=function(){this.last=this;this.first=this;this.position=new n.Point;this.scale=new n.Point(1,1);this.pivot=new n.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.buttonMode=!1;this.renderable=!1;this.parent=null;this.stage=null;this.worldAlpha=1;this._interactive=!1;this.defaultCursor="pointer";this.worldTransform=n.mat3.create();this.localTransform=n.mat3.create();this.color=[];this.dynamic=!0;this._sr=0;this._cr=1;this.filterArea=new n.Rectangle(0,0,1,1);this._bounds=new n.Rectangle(0,0,1,1);this._currentBounds=null;this._mask=null},n.DisplayObject.prototype.constructor=n.DisplayObject,n.DisplayObject.prototype.setInteractive=function(n){this.interactive=n},Object.defineProperty(n.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(n){this._interactive=n;this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"worldVisible",{get:function(){var n=this;do{if(!n.visible)return!1;n=n.parent}while(n);return!0}}),Object.defineProperty(n.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(n){this._mask&&(this._mask.isMask=!1);this._mask=n;this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(n){var r,t,u,i;if(n){for(r=[],t=0;t<n.length;t++)for(u=n[t].passes,i=0;i<u.length;i++)r.push(u[i]);this._filterBlock={target:this,filterPasses:r}}this._filters=n}}),n.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.localTransform,i=this.parent.worldTransform,r=this.worldTransform;t[0]=this._cr*this.scale.x;t[1]=-this._sr*this.scale.y;t[3]=this._sr*this.scale.x;t[4]=this._cr*this.scale.y;var c=this.pivot.x,l=this.pivot.y,a=t[0],v=t[1],u=this.position.x-t[0]*c-l*t[1],y=t[3],p=t[4],f=this.position.y-t[4]*l-c*t[3],e=i[0],o=i[1],w=i[2],s=i[3],h=i[4],b=i[5];t[2]=u;t[5]=f;r[0]=e*a+o*y;r[1]=e*v+o*p;r[2]=e*u+o*f+w;r[3]=s*a+h*y;r[4]=s*v+h*p;r[5]=s*u+h*f+b;this.worldAlpha=this.alpha*this.parent.worldAlpha;this.vcount=n.visibleCount},n.DisplayObject.prototype.getBounds=function(){return n.EmptyRectangle},n.DisplayObject.prototype.getLocalBounds=function(){var i=this.worldTransform,t;return this.worldTransform=n.identityMatrix,this.updateTransform(),t=this.getBounds(),this.worldTransform=i,t},n.DisplayObject.prototype._renderWebGL=function(n){n=n},n.DisplayObject.prototype._renderCanvas=function(n){n=n},n.EmptyRectangle=new n.Rectangle(0,0,0,0),n.visibleCount=0,n.DisplayObjectContainer=function(){n.DisplayObject.call(this);this.children=[]},n.DisplayObjectContainer.prototype=Object.create(n.DisplayObject.prototype),n.DisplayObjectContainer.prototype.constructor=n.DisplayObjectContainer,n.DisplayObjectContainer.prototype.addChild=function(n){n.parent&&n.parent!==this&&n.parent.removeChild(n);n.parent=this;this.children.push(n);this.stage&&n.setStageReference(this.stage)},n.DisplayObjectContainer.prototype.addChildAt=function(n,t){if(t>=0&&t<=this.children.length)n.parent&&n.parent.removeChild(n),n.parent=this,this.children.splice(t,0,n),this.stage&&n.setStageReference(this.stage);else throw new Error(n+" The index "+t+" supplied is out of bounds "+this.children.length);},n.DisplayObjectContainer.prototype.swapChildren=function(n,t){if(n!==t){var i=this.children.indexOf(n),r=this.children.indexOf(t);if(i<0||r<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=t;this.children[r]=n}},n.DisplayObjectContainer.prototype.getChildAt=function(n){if(n>=0&&n<this.children.length)return this.children[n];throw new Error("The supplied DisplayObjects must be a child of the caller "+this);},n.DisplayObjectContainer.prototype.removeChild=function(n){var t=this.children.indexOf(n);if(t!==-1)this.stage&&n.removeStageReference(),n.parent=undefined,this.children.splice(t,1);else throw new Error(n+" The supplied DisplayObject must be a child of the caller "+this);},n.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){n.DisplayObject.prototype.updateTransform.call(this);for(var t=0,i=this.children.length;t<i;t++)this.children[t].updateTransform()}},n.DisplayObjectContainer.prototype.getBounds=function(){var f,c,l,i;if(this.children.length===0)return n.EmptyRectangle;var r=Infinity,u=Infinity,e=-Infinity,o=-Infinity,t,s,h;for(f=0,c=this.children.length;f<c;f++)(l=this.children[f],l.visible)&&(t=this.children[f].getBounds(),r=r<t.x?r:t.x,u=u<t.y?u:t.y,s=t.width+t.x,h=t.height+t.y,e=e>s?e:s,o=o>h?o:h);return i=this._bounds,i.x=r,i.y=u,i.width=e-r,i.height=o-u,i},n.DisplayObjectContainer.prototype.setStageReference=function(n){var t,i,r;for(this.stage=n,this._interactive&&(this.stage.dirty=!0),t=0,i=this.children.length;t<i;t++)r=this.children[t],r.setStageReference(n)},n.DisplayObjectContainer.prototype.removeStageReference=function(){for(var i,n=0,t=this.children.length;n<t;n++)i=this.children[n],i.removeStageReference();this._interactive&&(this.stage.dirty=!0);this.stage=null},n.DisplayObjectContainer.prototype._renderWebGL=function(n){if(this.visible!==!1&&this.alpha!==0){var t,i;if(this._mask||this._filters){for(this._mask&&(n.spriteBatch.stop(),n.maskManager.pushMask(this.mask,n),n.spriteBatch.start()),this._filters&&(n.spriteBatch.flush(),n.filterManager.pushFilter(this._filterBlock)),t=0,i=this.children.length;t<i;t++)this.children[t]._renderWebGL(n);n.spriteBatch.stop();this._filters&&n.filterManager.popFilter();this._mask&&n.maskManager.popMask(n);n.spriteBatch.start()}else for(t=0,i=this.children.length;t<i;t++)this.children[t]._renderWebGL(n)}},n.DisplayObjectContainer.prototype._renderCanvas=function(n){var t,i,r;if(this.visible!==!1&&this.alpha!==0){for(this._mask&&n.maskManager.pushMask(this._mask,n.context),t=0,i=this.children.length;t<i;t++)r=this.children[t],r._renderCanvas(n);this._mask&&n.maskManager.popMask(n.context)}},n.blendModes={},n.blendModes.NORMAL=0,n.blendModes.ADD=1,n.blendModes.MULTIPLY=2,n.blendModes.SCREEN=3,n.Sprite=function(t){n.DisplayObjectContainer.call(this);this.anchor=new n.Point;this.texture=t;this._width=0;this._height=0;this.tint=16777215;this.blendMode=n.blendModes.NORMAL;t.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));this.renderable=!0},n.Sprite.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Sprite.prototype.constructor=n.Sprite,Object.defineProperty(n.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(n){this.scale.x=n/this.texture.frame.width;this._width=n}}),Object.defineProperty(n.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(n){this.scale.y=n/this.texture.frame.height;this._height=n}}),n.Sprite.prototype.setTexture=function(n){this.texture.baseTexture!==n.baseTexture?(this.textureChange=!0,this.texture=n):this.texture=n;this.cachedTint=16777215;this.updateFrame=!0},n.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height);this.updateFrame=!0},n.Sprite.prototype.getBounds=function(){var rt=this.texture.frame.width,ut=this.texture.frame.height,e=rt*(1-this.anchor.x),o=rt*-this.anchor.x,s=ut*(1-this.anchor.y),h=ut*-this.anchor.y,f=this.worldTransform,c=f[0],l=f[3],a=f[1],v=f[4],y=f[2],p=f[5],w=c*o+a*h+y,b=v*h+l*o+p,k=c*e+a*h+y,d=v*h+l*e+p,g=c*e+a*s+y,nt=v*s+l*e+p,tt=c*o+a*s+y,it=v*s+l*o+p,i=-Infinity,r=-Infinity,n=Infinity,t=Infinity,u;return n=w<n?w:n,n=k<n?k:n,n=g<n?g:n,n=tt<n?tt:n,t=b<t?b:t,t=d<t?d:t,t=nt<t?nt:t,t=it<t?it:t,i=w>i?w:i,i=k>i?k:i,i=g>i?g:i,i=tt>i?tt:i,r=b>r?b:r,r=d>r?d:r,r=nt>r?nt:r,r=it>r?it:r,u=this._bounds,u.x=n,u.width=i-n,u.y=t,u.height=r-t,this._currentBounds=u,u},n.Sprite.prototype._renderWebGL=function(n){var t,r,i;if(this.visible!==!1&&this.alpha!==0)if(this._mask||this._filters){for(i=n.spriteBatch,this._mask&&(i.stop(),n.maskManager.pushMask(this.mask,n),i.start()),this._filters&&(i.flush(),n.filterManager.pushFilter(this._filterBlock)),i.render(this),t=0,r=this.children.length;t<r;t++)this.children[t]._renderWebGL(n);i.stop();this._filters&&n.filterManager.popFilter();this._mask&&n.maskManager.popMask(n);i.start()}else for(n.spriteBatch.render(this),t=0,r=this.children.length;t<r;t++)this.children[t]._renderWebGL(n)},n.Sprite.prototype._renderCanvas=function(t){var r,f,o,s,h;if(this.visible!==!1&&this.alpha!==0){this._mask&&t.maskManager.pushMask(this._mask,t.context);var i=this.texture.frame,u=t.context,e=this.texture;if(i&&i.width&&i.height&&e.baseTexture.source)if(u.globalAlpha=this.worldAlpha,r=this.worldTransform,u.setTransform(r[0],r[3],r[1],r[4],r[2],r[5]),this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,u.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this.tint!==16777215){if(this.cachedTint!==this.tint){if(!e.baseTexture.hasLoaded)return;this.cachedTint=this.tint;this.tintedTexture=n.CanvasTinter.getTintedTexture(this,this.tint)}u.drawImage(this.tintedTexture,0,0,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height)}else e.trimmed?(f=e.trim,u.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,f.x-this.anchor.x*f.realWidth,f.y-this.anchor.y*f.realHeight,i.width,i.height)):u.drawImage(this.texture.baseTexture.source,i.x,i.y,i.width,i.height,this.anchor.x*-i.width,this.anchor.y*-i.height,i.width,i.height);for(o=0,s=this.children.length;o<s;o++)h=this.children[o],h._renderCanvas(t);this._mask&&t.maskManager.popMask(t.context)}},n.Sprite.fromFrame=function(t){var i=n.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new n.Sprite(i)},n.Sprite.fromImage=function(t){var i=n.Texture.fromImage(t);return new n.Sprite(i)},n.MovieClip=function(t){n.Sprite.call(this,t[0]);this.textures=t;this.animationSpeed=1;this.loop=!0;this.onComplete=null;this.currentFrame=0;this.playing=!1},n.MovieClip.prototype=Object.create(n.Sprite.prototype),n.MovieClip.prototype.constructor=n.MovieClip,Object.defineProperty(n.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),n.MovieClip.prototype.stop=function(){this.playing=!1},n.MovieClip.prototype.play=function(){this.playing=!0},n.MovieClip.prototype.gotoAndStop=function(n){this.playing=!1;this.currentFrame=n;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])},n.MovieClip.prototype.gotoAndPlay=function(n){this.currentFrame=n;this.playing=!0},n.MovieClip.prototype.updateTransform=function(){if(n.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},n.FilterBlock=function(){this.visible=!0;this.renderable=!0},n.Text=function(t,i){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");n.Sprite.call(this,n.Texture.fromCanvas(this.canvas));this.setText(t);this.setStyle(i);this.updateText();this.dirty=!1},n.Text.prototype=Object.create(n.Sprite.prototype),n.Text.prototype.constructor=n.Text,n.Text.prototype.setStyle=function(n){n=n||{};n.font=n.font||"bold 20pt Arial";n.fill=n.fill||"black";n.align=n.align||"left";n.stroke=n.stroke||"black";n.strokeThickness=n.strokeThickness||0;n.wordWrap=n.wordWrap||!1;n.wordWrapWidth=n.wordWrapWidth||100;this.style=n;this.dirty=!0},n.Text.prototype.setText=function(n){this.text=n.toString()||" ";this.dirty=!0},n.Text.prototype.updateText=function(){var f,t,o,s,i;this.context.font=this.style.font;f=this.text;this.style.wordWrap&&(f=this.wordWrap(this.text));var r=f.split(/(?:\r\n|\r|\n)/),e=[],u=0;for(t=0;t<r.length;t++)o=this.context.measureText(r[t]).width,e[t]=o,u=Math.max(u,o);for(this.canvas.width=u+this.style.strokeThickness,s=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,this.canvas.height=s*r.length,this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",t=0;t<r.length;t++)i=new n.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+t*s),this.style.align==="right"?i.x+=u-e[t]:this.style.align==="center"&&(i.x+=(u-e[t])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(r[t],i.x,i.y),this.style.fill&&this.context.fillText(r[t],i.x,i.y);this.updateTexture()},n.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.frame.width=this.canvas.width;this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;this.requiresUpdate=!0},n.Text.prototype._renderWebGL=function(t){this.requiresUpdate&&(this.requiresUpdate=!1,n.updateWebGLTexture(this.texture.baseTexture,t.gl));n.Sprite.prototype._renderWebGL.call(this,t)},n.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1);n.Sprite.prototype.updateTransform.call(this)},n.Text.prototype.determineFontHeight=function(t){var r=n.Text.heightCache[t];if(!r){var u=document.getElementsByTagName("body")[0],i=document.createElement("div"),f=document.createTextNode("M");i.appendChild(f);i.setAttribute("style",t+";position:absolute;top:0;left:0");u.appendChild(i);r=i.offsetHeight;n.Text.heightCache[t]=r;u.removeChild(i)}return r},n.Text.prototype.wordWrap=function(n){for(var u,r,t,e,o,i="",s=n.split("\n"),f=0;f<s.length;f++){for(u=this.style.wordWrapWidth,r=s[f].split(" "),t=0;t<r.length;t++)e=this.context.measureText(r[t]).width,o=e+this.context.measureText(" ").width,o>u?(t>0&&(i+="\n"),i+=r[t]+" ",u=this.style.wordWrapWidth-e):(u-=o,i+=r[t]+" ");i+="\n"}return i},n.Text.prototype.destroy=function(n){n&&this.texture.destroy()},n.Text.heightCache={},n.BitmapText=function(t,i){n.DisplayObjectContainer.call(this);this.setText(t);this.setStyle(i);this.updateText();this.dirty=!1},n.BitmapText.prototype=Object.create(n.DisplayObjectContainer.prototype),n.BitmapText.prototype.constructor=n.BitmapText,n.BitmapText.prototype.setText=function(n){this.text=n||" ";this.dirty=!0},n.BitmapText.prototype.setStyle=function(t){t=t||{};t.align=t.align||"left";this.style=t;var i=t.font.split(" ");this.fontName=i[i.length-1];this.fontSize=i.length>=2?parseInt(i[i.length-2],10):n.BitmapText.fonts[this.fontName].size;this.dirty=!0},n.BitmapText.prototype.updateText=function(){for(var l,r,y,a,e,h=n.BitmapText.fonts[this.fontName],i=new n.Point,o=null,f=[],u=0,c=[],v=0,s=this.fontSize/h.size,t=0;t<this.text.length;t++){if(l=this.text.charCodeAt(t),/(?:\r\n|\r|\n)/.test(this.text.charAt(t))){c.push(i.x);u=Math.max(u,i.x);v++;i.x=0;i.y+=h.lineHeight;o=null;continue}(r=h.chars[l],r)&&(o&&r[o]&&(i.x+=r.kerning[o]),f.push({texture:r.texture,line:v,charCode:l,position:new n.Point(i.x+r.xOffset,i.y+r.yOffset)}),i.x+=r.xAdvance,o=l)}for(c.push(i.x),u=Math.max(u,i.x),y=[],t=0;t<=v;t++)a=0,this.style.align==="right"?a=u-c[t]:this.style.align==="center"&&(a=(u-c[t])/2),y.push(a);for(t=0;t<f.length;t++)e=new n.Sprite(f[t].texture),e.position.x=(f[t].position.x+y[f[t].line])*s,e.position.y=f[t].position.y*s,e.scale.x=e.scale.y=s,this.addChild(e);this.width=u*s;this.height=(i.y+h.lineHeight)*s},n.BitmapText.prototype.updateTransform=function(){if(this.dirty){while(this.children.length>0)this.removeChild(this.getChildAt(0));this.updateText();this.dirty=!1}n.DisplayObjectContainer.prototype.updateTransform.call(this)},n.BitmapText.fonts={},n.InteractionManager=function(t){this.stage=t;this.mouse=new n.InteractionData;this.touchs={};this.tempPoint=new n.Point;this.mouseoverEnabled=!0;this.pool=[];this.interactiveItems=[];this.interactionDOMElement=null;this.onMouseMove=this.onMouseMove.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.onMouseUp=this.onMouseUp.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);this.onTouchMove=this.onTouchMove.bind(this);this.last=0},n.InteractionManager.prototype.constructor=n.InteractionManager,n.InteractionManager.prototype.collectInteractiveSprite=function(n,t){for(var i,u=n.children,f=u.length,r=f-1;r>=0;r--)i=u[r],i.interactive?(t.interactiveChildren=!0,this.interactiveItems.push(i),i.children.length>0&&this.collectInteractiveSprite(i,i)):(i.__iParent=null,i.children.length>0&&this.collectInteractiveSprite(i,t))},n.InteractionManager.prototype.setTarget=function(n){this.target=n;this.interactionDOMElement===null&&this.setTargetDomElement(n.view);document.body.addEventListener("mouseup",this.onMouseUp,!0)},n.InteractionManager.prototype.setTargetDomElement=function(n){this.interactionDOMElement!==null&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0));window.navigator.msPointerEnabled&&(n.style["-ms-content-zooming"]="none",n.style["-ms-touch-action"]="none");this.interactionDOMElement=n;n.addEventListener("mousemove",this.onMouseMove,!0);n.addEventListener("mousedown",this.onMouseDown,!0);n.addEventListener("mouseout",this.onMouseOut,!0);n.addEventListener("touchstart",this.onTouchStart,!0);n.addEventListener("touchend",this.onTouchEnd,!0);n.addEventListener("touchmove",this.onTouchMove,!0)},n.InteractionManager.prototype.update=function(){var r,i,t,u,f,n;if(this.target&&(r=Date.now(),i=r-this.last,i=i*30/1e3,!(i<1))){if(this.last=r,t=0,this.dirty){for(this.dirty=!1,u=this.interactiveItems.length,t=0;t<u;t++)this.interactiveItems[t].interactiveChildren=!1;this.interactiveItems=[];this.stage.interactive&&this.interactiveItems.push(this.stage);this.collectInteractiveSprite(this.stage,this.stage)}for(f=this.interactiveItems.length,this.interactionDOMElement.style.cursor="inherit",t=0;t<f;t++)n=this.interactiveItems[t],(n.mouseover||n.mouseout||n.buttonMode)&&(n.__hit=this.hitTest(n,this.mouse),this.mouse.target=n,n.__hit?(n.buttonMode&&(this.interactionDOMElement.style.cursor=n.defaultCursor),n.__isOver||(n.mouseover&&n.mouseover(this.mouse),n.__isOver=!0)):n.__isOver&&(n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1))}},n.InteractionManager.prototype.onMouseMove=function(n){var t,u,i,r;for(this.mouse.originalEvent=n||window.event,t=this.interactionDOMElement.getBoundingClientRect(),this.mouse.global.x=(n.clientX-t.left)*(this.target.width/t.width),this.mouse.global.y=(n.clientY-t.top)*(this.target.height/t.height),u=this.interactiveItems.length,i=0;i<u;i++)r=this.interactiveItems[i],r.mousemove&&r.mousemove(this.mouse)},n.InteractionManager.prototype.onMouseDown=function(n){var r,i,t;for(this.mouse.originalEvent=n||window.event,r=this.interactiveItems.length,i=0;i<r;i++)if(t=this.interactiveItems[i],(t.mousedown||t.click)&&(t.__mouseIsDown=!0,t.__hit=this.hitTest(t,this.mouse),t.__hit&&(t.mousedown&&t.mousedown(this.mouse),t.__isDown=!0,!t.interactiveChildren)))break},n.InteractionManager.prototype.onMouseOut=function(){var i=this.interactiveItems.length,t,n;for(this.interactionDOMElement.style.cursor="inherit",t=0;t<i;t++)n=this.interactiveItems[t],n.__isOver&&(this.mouse.target=n,n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1)},n.InteractionManager.prototype.onMouseUp=function(n){var u,r,i,t;for(this.mouse.originalEvent=n||window.event,u=this.interactiveItems.length,r=!1,i=0;i<u;i++)t=this.interactiveItems[i],(t.mouseup||t.mouseupoutside||t.click)&&(t.__hit=this.hitTest(t,this.mouse),t.__hit&&!r?(t.mouseup&&t.mouseup(this.mouse),t.__isDown&&t.click&&t.click(this.mouse),t.interactiveChildren||(r=!0)):t.__isDown&&t.mouseupoutside&&t.mouseupoutside(this.mouse),t.__isDown=!1)},n.InteractionManager.prototype.hitTest=function(t,i){var f=i.global,d,e,g,nt;if(!t.worldVisible)return!1;var tt=t instanceof n.Sprite,r=t.worldTransform,o=r[0],s=r[1],y=r[2],h=r[3],c=r[4],p=r[5],u=1/(o*c+s*-h),l=c*u*f.x+-s*u*f.y+(p*s-y*c)*u,a=o*u*f.y+-h*u*f.x+(-p*o+y*h)*u;if(i.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(l,a)?(i.target=t,!0):!1;if(tt){var w=t.texture.frame.width,b=t.texture.frame.height,k=-w*t.anchor.x,v;if(l>k&&l<k+w&&(v=-b*t.anchor.y,a>v&&a<v+b))return i.target=t,!0}for(d=t.children.length,e=0;e<d;e++)if(g=t.children[e],nt=this.hitTest(g,i),nt)return i.target=t,!0;return!1},n.InteractionManager.prototype.onTouchMove=function(n){for(var r=this.interactionDOMElement.getBoundingClientRect(),e=n.changedTouches,i,t=0,u,o,f,t=0;t<e.length;t++)u=e[t],i=this.touchs[u.identifier],i.originalEvent=n||window.event,i.global.x=(u.clientX-r.left)*(this.target.width/r.width),i.global.y=(u.clientY-r.top)*(this.target.height/r.height);for(o=this.interactiveItems.length,t=0;t<o;t++)f=this.interactiveItems[t],f.touchmove&&f.touchmove(i)},n.InteractionManager.prototype.onTouchStart=function(t){for(var f,r,h,e,i,u=this.interactionDOMElement.getBoundingClientRect(),s=t.changedTouches,o=0;o<s.length;o++)for(f=s[o],r=this.pool.pop(),r||(r=new n.InteractionData),r.originalEvent=t||window.event,this.touchs[f.identifier]=r,r.global.x=(f.clientX-u.left)*(this.target.width/u.width),r.global.y=(f.clientY-u.top)*(this.target.height/u.height),h=this.interactiveItems.length,e=0;e<h;e++)if(i=this.interactiveItems[e],(i.touchstart||i.tap)&&(i.__hit=this.hitTest(i,r),i.__hit&&(i.touchstart&&i.touchstart(r),i.__isDown=!0,i.__touchData=r,!i.interactiveChildren)))break},n.InteractionManager.prototype.onTouchEnd=function(n){for(var h,f,t,c,r=this.interactionDOMElement.getBoundingClientRect(),o=n.changedTouches,e=0;e<o.length;e++){var u=o[e],i=this.touchs[u.identifier],s=!1;for(i.global.x=(u.clientX-r.left)*(this.target.width/r.width),i.global.y=(u.clientY-r.top)*(this.target.height/r.height),h=this.interactiveItems.length,f=0;f<h;f++)t=this.interactiveItems[f],c=t.__touchData,t.__hit=this.hitTest(t,i),c===i&&(i.originalEvent=n||window.event,(t.touchend||t.tap)&&(t.__hit&&!s?(t.touchend&&t.touchend(i),t.__isDown&&t.tap&&t.tap(i),t.interactiveChildren||(s=!0)):t.__isDown&&t.touchendoutside&&t.touchendoutside(i),t.__isDown=!1),t.__touchData=null);this.pool.push(i);this.touchs[u.identifier]=null}},n.InteractionData=function(){this.global=new n.Point;this.local=new n.Point;this.target=null;this.originalEvent=null},n.InteractionData.prototype.getLocalPosition=function(t){var i=t.worldTransform,u=this.global,f=i[0],e=i[1],h=i[2],o=i[3],s=i[4],c=i[5],r=1/(f*s+e*-o);return new n.Point(s*r*u.x+-e*r*u.y+(c*e-h*s)*r,f*r*u.y+-o*r*u.x+(-c*f+h*o)*r)},n.InteractionData.prototype.constructor=n.InteractionData,n.Stage=function(t){n.DisplayObjectContainer.call(this);this.worldTransform=n.mat3.create();this.interactive=!0;this.interactionManager=new n.InteractionManager(this);this.dirty=!0;this.__childrenAdded=[];this.__childrenRemoved=[];this.stage=this;this.stage.hitArea=new n.Rectangle(0,0,1e5,1e5);this.setBackgroundColor(t);this.worldVisible=!0},n.Stage.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Stage.prototype.constructor=n.Stage,n.Stage.prototype.setInteractionDelegate=function(n){this.interactionManager.setTargetDomElement(n)},n.Stage.prototype.updateTransform=function(){this.worldAlpha=1;this.vcount=n.visibleCount;for(var t=0,i=this.children.length;t<i;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0);this.interactive&&this.interactionManager.update()},n.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0;this.backgroundColorSplit=n.hex2rgb(this.backgroundColor);var i=this.backgroundColor.toString(16);i="000000".substr(0,6-i.length)+i;this.backgroundColorString="#"+i},n.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},f=0,u=["ms","moz","webkit","o"],i=0;i<u.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[u[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[u[i]+"CancelAnimationFrame"]||window[u[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-f)),r=window.setTimeout(function(){n(t+i)},i);return f=t+i,r});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)});window.requestAnimFrame=window.requestAnimationFrame;n.hex2rgb=function(n){return[(n>>16&255)/255,(n>>8&255)/255,(n&255)/255]};n.rgb2hex=function(n){return(n[0]*255<<16)+(n[1]*255<<8)+n[2]*255};typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(){var n=Array.prototype.slice;return function(t){function r(){var u=f.concat(n.call(arguments));i.apply(this instanceof r?this:t,u)}var i=this,f=n.call(arguments,1);if(typeof i!="function")throw new TypeError;return r.prototype=function u(n){return n&&(u.prototype=n),(this instanceof u)?void 0:new u}(i.prototype),r}}());n.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],n;if(window.ActiveXObject)for(n=0;n<t.length;n++)try{return new window.ActiveXObject(t[n])}catch(i){}else return window.XMLHttpRequest?new window.XMLHttpRequest:!1};n.canUseNewCanvasBlendModes=function(){var t=document.createElement("canvas"),n;return t.width=1,t.height=1,n=t.getContext("2d"),n.fillStyle="#000",n.fillRect(0,0,1,1),n.globalCompositeOperation="multiply",n.fillStyle="#fff",n.fillRect(0,0,1,1),n.getImageData(0,0,1,1).data[0]===0};n.getNextPowerOfTwo=function(n){if(n>0&&(n&n-1)==0)return n;for(var t=1;t<n;)t<<=1;return t};n.EventTarget=function(){var n={};this.addEventListener=this.on=function(t,i){n[t]===undefined&&(n[t]=[]);n[t].indexOf(i)===-1&&n[t].push(i)};this.dispatchEvent=this.emit=function(t){if(n[t.type]&&n[t.type].length)for(var i=0,r=n[t.type].length;i<r;i++)n[t.type][i](t)};this.removeEventListener=this.off=function(t,i){var r=n[t].indexOf(i);r!==-1&&n[t].splice(r,1)};this.removeAllEventListeners=function(t){var i=n[t];i&&(i.length=0)}};n.autoDetectRenderer=function(t,i,r,u,f){var e,o;return(t||(t=800),i||(i=600),e=function(){try{var n=document.createElement("canvas");return!!window.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl"))}catch(t){return!1}}(),e&&(o=navigator.userAgent.toLowerCase().indexOf("trident")!==-1,e=!o),e)?new n.WebGLRenderer(t,i,r,u,f):new n.CanvasRenderer(t,i,r,u)};n.PolyK={};n.PolyK.Triangulate=function(t){var a=!0,e=t.length>>1,o,r,i,u,l,f;if(e<3)return[];for(o=[],r=[],i=0;i<e;i++)r.push(i);for(i=0,u=e;u>3;){var s=r[(i+0)%u],h=r[(i+1)%u],c=r[(i+2)%u],y=t[2*s],p=t[2*s+1],w=t[2*h],b=t[2*h+1],k=t[2*c],d=t[2*c+1],v=!1;if(n.PolyK._convex(y,p,w,b,k,d,a))for(v=!0,l=0;l<u;l++)if((f=r[l],f!==s&&f!==h&&f!==c)&&n.PolyK._PointInTriangle(t[2*f],t[2*f+1],y,p,w,b,k,d)){v=!1;break}if(v)o.push(s,h,c),r.splice((i+1)%u,1),u--,i=0;else if(i++>3*u)if(a){for(o=[],r=[],i=0;i<e;i++)r.push(i);i=0;u=e;a=!1}else return window.console.log("PIXI Warning: shape too complex to fill"),[]}return o.push(r[0],r[1],r[2]),o};n.PolyK._PointInTriangle=function(n,t,i,r,u,f,e,o){var s=e-i,h=o-r,c=u-i,l=f-r,v=n-i,y=t-r,p=s*s+h*h,a=s*c+h*l,w=s*v+h*y,b=c*c+l*l,k=c*v+l*y,d=1/(p*b-a*a),g=(b*w-a*k)*d,nt=(p*k-a*w)*d;return g>=0&&nt>=0&&g+nt<1};n.PolyK._convex=function(n,t,i,r,u,f,e){return(t-r)*(u-i)+(i-n)*(f-r)>=0===e};n.initDefaultShaders=function(){};n.CompileVertexShader=function(t,i){return n._CompileShader(t,i,t.VERTEX_SHADER)};n.CompileFragmentShader=function(t,i){return n._CompileShader(t,i,t.FRAGMENT_SHADER)};n._CompileShader=function(n,t,i){var u=t.join("\n"),r=n.createShader(i);return(n.shaderSource(r,u),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))?(window.console.log(n.getShaderInfoLog(r)),null):r};n.compileProgram=function(t,i,r){var f=n.CompileFragmentShader(t,r),e=n.CompileVertexShader(t,i),u=t.createProgram();return t.attachShader(u,e),t.attachShader(u,f),t.linkProgram(u),t.getProgramParameter(u,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),u};n.PixiShader=function(n){this.gl=n;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.init()};n.PixiShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc||n.PixiShader.defaultVertexSrc,this.fragmentSrc),r;t.useProgram(i);this.uSampler=t.getUniformLocation(i,"uSampler");this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.dimensions=t.getUniformLocation(i,"dimensions");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord");this.colorAttribute=t.getAttribLocation(i,"aColor");this.colorAttribute===-1&&(this.colorAttribute=2);for(r in this.uniforms)this.uniforms[r].uniformLocation=t.getUniformLocation(i,r);this.initUniforms();this.program=i};n.PixiShader.prototype.initUniforms=function(){var i,t,r,n;this.textureCount=1;i=this.gl;for(r in this.uniforms)t=this.uniforms[r],n=t.type,n==="sampler2D"?(t._init=!1,t.value!==null&&this.initSampler2D(t)):n==="mat2"||n==="mat3"||n==="mat4"?(t.glMatrix=!0,t.glValueLength=1,n==="mat2"?t.glFunc=i.uniformMatrix2fv:n==="mat3"?t.glFunc=i.uniformMatrix3fv:n==="mat4"&&(t.glFunc=i.uniformMatrix4fv)):(t.glFunc=i["uniform"+n],t.glValueLength=n==="2f"||n==="2i"?2:n==="3f"||n==="3i"?3:n==="4f"||n==="4i"?4:1)};n.PixiShader.prototype.initSampler2D=function(n){var t;if(n.value&&n.value.baseTexture&&n.value.baseTexture.hasLoaded){if(t=this.gl,t.activeTexture(t["TEXTURE"+this.textureCount]),t.bindTexture(t.TEXTURE_2D,n.value.baseTexture._glTexture),n.textureData){var i=n.textureData,e=i.magFilter?i.magFilter:t.LINEAR,o=i.minFilter?i.minFilter:t.LINEAR,u=i.wrapS?i.wrapS:t.CLAMP_TO_EDGE,f=i.wrapT?i.wrapT:t.CLAMP_TO_EDGE,r=i.luminance?t.LUMINANCE:t.RGBA;if(i.repeat&&(u=t.REPEAT,f=t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),i.width){var s=i.width?i.width:512,h=i.height?i.height:2,c=i.border?i.border:0;t.texImage2D(t.TEXTURE_2D,0,r,s,h,c,r,t.UNSIGNED_BYTE,null)}else t.texImage2D(t.TEXTURE_2D,0,r,t.RGBA,t.UNSIGNED_BYTE,n.value.baseTexture.source);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,u);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,f)}t.uniform1i(n.uniformLocation,this.textureCount);n._init=!0;this.textureCount++}};n.PixiShader.prototype.syncUniforms=function(){var t,i,r;this.textureCount=1;i=this.gl;for(r in this.uniforms)t=this.uniforms[r],t.glValueLength===1?t.glMatrix===!0?t.glFunc.call(i,t.uniformLocation,t.transpose,t.value):t.glFunc.call(i,t.uniformLocation,t.value):t.glValueLength===2?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y):t.glValueLength===3?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z):t.glValueLength===4?t.glFunc.call(i,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):t.type==="sampler2D"&&(t._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),i.bindTexture(i.TEXTURE_2D,t.value.baseTexture._glTextures[i.id]||n.createWebGLTexture(t.value.baseTexture,i)),i.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))};n.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"];n.StripShader=function(){this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","   gl_FragColor = gl_FragColor * alpha;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","uniform vec2 offsetVector;","varying float vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"]};n.StripShader.prototype.init=function(){var t=n.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.uSampler=t.getUniformLocation(i,"uSampler");this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.colorAttribute=t.getAttribLocation(i,"aColor");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.aTextureCoord=t.getAttribLocation(i,"aTextureCoord");this.translationMatrix=t.getUniformLocation(i,"translationMatrix");this.alpha=t.getUniformLocation(i,"alpha");this.program=i};n.PrimitiveShader=function(n){this.gl=n;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};n.PrimitiveShader.prototype.init=function(){var t=this.gl,i=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(i);this.projectionVector=t.getUniformLocation(i,"projectionVector");this.offsetVector=t.getUniformLocation(i,"offsetVector");this.tintColor=t.getUniformLocation(i,"tint");this.aVertexPosition=t.getAttribLocation(i,"aVertexPosition");this.colorAttribute=t.getAttribLocation(i,"aColor");this.translationMatrix=t.getUniformLocation(i,"translationMatrix");this.alpha=t.getUniformLocation(i,"alpha");this.program=i};n.WebGLGraphics=function(){};n.WebGLGraphics.renderGraphics=function(t,i){var r=i.gl,o=i.projection,s=i.offset,u=i.shaderManager.primitiveShader,f,e;t._webGL[r.id]||(t._webGL[r.id]={points:[],indices:[],lastIndex:0,buffer:r.createBuffer(),indexBuffer:r.createBuffer()});f=t._webGL[r.id];t.dirty&&(t.dirty=!1,t.clearDirty&&(t.clearDirty=!1,f.lastIndex=0,f.points=[],f.indices=[]),n.WebGLGraphics.updateGraphics(t,r));i.shaderManager.activatePrimitiveShader();e=n.mat3.clone(t.worldTransform);n.mat3.transpose(e);r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA);r.uniformMatrix3fv(u.translationMatrix,!1,e);r.uniform2f(u.projectionVector,o.x,-o.y);r.uniform2f(u.offsetVector,-s.x,-s.y);r.uniform3fv(u.tintColor,n.hex2rgb(t.tint));r.uniform1f(u.alpha,t.worldAlpha);r.bindBuffer(r.ARRAY_BUFFER,f.buffer);r.vertexAttribPointer(u.aVertexPosition,2,r.FLOAT,!1,24,0);r.vertexAttribPointer(u.colorAttribute,4,r.FLOAT,!1,24,8);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.indexBuffer);r.drawElements(r.TRIANGLE_STRIP,f.indices.length,r.UNSIGNED_SHORT,0);i.shaderManager.deactivatePrimitiveShader()};n.WebGLGraphics.updateGraphics=function(t,i){for(var u,r=t._webGL[i.id],f=r.lastIndex;f<t.graphicsData.length;f++)u=t.graphicsData[f],u.type===n.Graphics.POLY?(u.fill&&u.points.length>3&&n.WebGLGraphics.buildPoly(u,r),u.lineWidth>0&&n.WebGLGraphics.buildLine(u,r)):u.type===n.Graphics.RECT?n.WebGLGraphics.buildRectangle(u,r):(u.type===n.Graphics.CIRC||u.type===n.Graphics.ELIP)&&n.WebGLGraphics.buildCircle(u,r);r.lastIndex=t.graphicsData.length;r.glPoints=new Float32Array(r.points);i.bindBuffer(i.ARRAY_BUFFER,r.buffer);i.bufferData(i.ARRAY_BUFFER,r.glPoints,i.STATIC_DRAW);r.glIndicies=new Uint16Array(r.indices);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r.indexBuffer);i.bufferData(i.ELEMENT_ARRAY_BUFFER,r.glIndicies,i.STATIC_DRAW)};n.WebGLGraphics.buildRectangle=function(t,i){var s=t.points,r=s[0],u=s[1],h=s[2],c=s[3];if(t.fill){var y=n.hex2rgb(t.fillColor),e=t.fillAlpha,l=y[0]*e,a=y[1]*e,v=y[2]*e,f=i.points,p=i.indices,o=f.length/6;f.push(r,u);f.push(l,a,v,e);f.push(r+h,u);f.push(l,a,v,e);f.push(r,u+c);f.push(l,a,v,e);f.push(r+h,u+c);f.push(l,a,v,e);p.push(o,o,o+1,o+2,o+3,o+3)}t.lineWidth&&(t.points=[r,u,r+h,u,r+h,u+c,r,u+c,r,u],n.WebGLGraphics.buildLine(t,i))};n.WebGLGraphics.buildCircle=function(t,i){var f=t.points,s=f[0],h=f[1],y=f[2],p=f[3],c=40,e=Math.PI*2/c,r=0;if(t.fill){var l=n.hex2rgb(t.fillColor),u=t.fillAlpha,w=l[0]*u,b=l[1]*u,k=l[2]*u,a=i.points,v=i.indices,o=a.length/6;for(v.push(o),r=0;r<c+1;r++)a.push(s,h,w,b,k,u),a.push(s+Math.sin(e*r)*y,h+Math.cos(e*r)*p,w,b,k,u),v.push(o++,o++);v.push(o-1)}if(t.lineWidth){for(t.points=[],r=0;r<c+1;r++)t.points.push(s+Math.sin(e*r)*y,h+Math.cos(e*r)*p);n.WebGLGraphics.buildLine(t,i)}};n.WebGLGraphics.buildLine=function(t,i){var h=0,r=t.points,it,g,ht,ct;if(r.length!==0){if(t.lineWidth%2)for(h=0;h<r.length;h++)r[h]+=.5;it=new n.Point(r[0],r[1]);g=new n.Point(r[r.length-2],r[r.length-1]);it.x===g.x&&it.y===g.y&&(r.pop(),r.pop(),g=new n.Point(r[r.length-2],r[r.length-1]),ht=g.x+(it.x-g.x)*.5,ct=g.y+(it.y-g.y)*.5,r.unshift(ht,ct),r.push(ht,ct));var s=i.points,lt=i.indices,rt=r.length/2,gt=r.length,at=s.length/6,p=t.lineWidth/2,vt=n.hex2rgb(t.lineColor),l=t.lineAlpha,a=vt[0]*l,v=vt[1]*l,y=vt[2]*l,ut,ft,w,b,e,o,ot,st,u,f,k,d,nt,tt,yt,pt,wt,bt,kt,dt,et,ni,c;for(w=r[0],b=r[1],e=r[2],o=r[3],u=-(b-o),f=w-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=p,f*=p,s.push(w-u,b-f,a,v,y,l),s.push(w+u,b+f,a,v,y,l),h=1;h<rt-1;h++){if(w=r[(h-1)*2],b=r[(h-1)*2+1],e=r[h*2],o=r[h*2+1],ot=r[(h+1)*2],st=r[(h+1)*2+1],u=-(b-o),f=w-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=p,f*=p,k=-(o-st),d=e-ot,c=Math.sqrt(k*k+d*d),k/=c,d/=c,k*=p,d*=p,yt=-f+b-(-f+o),pt=-u+e-(-u+w),wt=(-u+w)*(-f+o)-(-u+e)*(-f+b),bt=-d+st-(-d+o),kt=-k+e-(-k+ot),dt=(-k+ot)*(-d+o)-(-k+e)*(-d+st),et=yt*kt-bt*pt,Math.abs(et)<.1){et+=10.1;s.push(e-u,o-f,a,v,y,l);s.push(e+u,o+f,a,v,y,l);continue}ut=(pt*dt-kt*wt)/et;ft=(bt*wt-yt*dt)/et;ni=(ut-e)*(ut-e)+(ft-o)+(ft-o);ni>19600?(nt=u-k,tt=f-d,c=Math.sqrt(nt*nt+tt*tt),nt/=c,tt/=c,nt*=p,tt*=p,s.push(e-nt,o-tt),s.push(a,v,y,l),s.push(e+nt,o+tt),s.push(a,v,y,l),s.push(e-nt,o-tt),s.push(a,v,y,l),gt++):(s.push(ut,ft),s.push(a,v,y,l),s.push(e-(ut-e),o-(ft-o)),s.push(a,v,y,l))}for(w=r[(rt-2)*2],b=r[(rt-2)*2+1],e=r[(rt-1)*2],o=r[(rt-1)*2+1],u=-(b-o),f=w-e,c=Math.sqrt(u*u+f*f),u/=c,f/=c,u*=p,f*=p,s.push(e-u,o-f),s.push(a,v,y,l),s.push(e+u,o+f),s.push(a,v,y,l),lt.push(at),h=0;h<gt;h++)lt.push(at++);lt.push(at-1)}};n.WebGLGraphics.buildPoly=function(t,i){var f=t.points;if(!(f.length<6)){for(var c=i.points,e=i.indices,l=f.length/2,h=n.hex2rgb(t.fillColor),s=t.fillAlpha,a=h[0]*s,v=h[1]*s,y=h[2]*s,u=n.PolyK.Triangulate(f),o=c.length/6,r=0,r=0;r<u.length;r+=3)e.push(u[r]+o),e.push(u[r]+o),e.push(u[r+1]+o),e.push(u[r+2]+o),e.push(u[r+2]+o);for(r=0;r<l;r++)c.push(f[r*2],f[r*2+1],a,v,y,s)}};n._defaultFrame=new n.Rectangle(0,0,1,1);n.gl=null;n.WebGLRenderer=function(t,i,r,u,f){var o,e;n.defaultRenderer||(n.defaultRenderer=this);this.type=n.WEBGL_RENDERER;this.transparent=!!u;this.width=t||800;this.height=i||600;this.view=r||document.createElement("canvas");this.view.width=this.width;this.view.height=this.height;o=this;this.view.addEventListener("webglcontextlost",function(n){o.handleContextLost(n)},!1);this.view.addEventListener("webglcontextrestored",function(n){o.handleContextRestored(n)},!1);this.batchs=[];this.options={alpha:this.transparent,antialias:!!f,premultipliedAlpha:!1,stencil:!0};try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(s){try{this.gl=this.view.getContext("webgl",this.options)}catch(h){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this);}}e=this.gl;this.glContextId=e.id=n.WebGLRenderer.glContextId++;n.blendModesWebGL||(n.blendModesWebGL=[],n.blendModesWebGL[n.blendModes.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.ADD]=[e.SRC_ALPHA,e.DST_ALPHA],n.blendModesWebGL[n.blendModes.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SCREEN]=[e.SRC_ALPHA,e.ONE]);this.projection=new n.Point;this.projection.x=this.width/2;this.projection.y=-this.height/2;this.offset=new n.Point(0,0);this.resize(this.width,this.height);this.contextLost=!1;this.shaderManager=new n.WebGLShaderManager(e);this.spriteBatch=new n.WebGLSpriteBatch(e);this.maskManager=new n.WebGLMaskManager(e);this.filterManager=new n.WebGLFilterManager(e,this.transparent);this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.spriteBatch=this.spriteBatch;e.useProgram(this.shaderManager.defaultShader.program);n.WebGLRenderer.gl=e;e.disable(e.DEPTH_TEST);e.disable(e.CULL_FACE);e.enable(e.BLEND);e.colorMask(!0,!0,!0,this.transparent)};n.WebGLRenderer.prototype.constructor=n.WebGLRenderer;n.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(this.__stage=t);n.WebGLRenderer.updateTextures();t.updateTransform();var i=this.gl;i.colorMask(!0,!0,!0,this.transparent);i.viewport(0,0,this.width,this.height);i.bindFramebuffer(i.FRAMEBUFFER,null);i.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],!this.transparent);i.clear(i.COLOR_BUFFER_BIT);this.renderDisplayObject(t,this.projection);t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)))}};n.WebGLRenderer.prototype.renderDisplayObject=function(n,t){this.renderSession.drawCount=0;this.renderSession.currentBlendMode=9999;this.renderSession.projection=t;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,null);n._renderWebGL(this.renderSession);this.spriteBatch.end()};n.WebGLRenderer.updateTextures=function(){for(var t=0,t=0;t<n.Texture.frameUpdates.length;t++)n.WebGLRenderer.updateTextureFrame(n.Texture.frameUpdates[t]);for(t=0;t<n.texturesToDestroy.length;t++)n.WebGLRenderer.destroyTexture(n.texturesToDestroy[t]);n.texturesToUpdate=[];n.texturesToDestroy=[];n.Texture.frameUpdates=[]};n.WebGLRenderer.destroyTexture=function(t){var i=n.gl;t._glTexture&&(t._glTexture=i.createTexture(),i.deleteTexture(i.TEXTURE_2D,t._glTexture))};n.WebGLRenderer.updateTextureFrame=function(n){n.updateFrame=!1;n._updateWebGLuvs()};n.WebGLRenderer.prototype.resize=function(n,t){this.width=n;this.height=t;this.view.width=n;this.view.height=t;this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2;this.projection.y=-this.height/2};n.createWebGLTexture=function(t,i){t.hasLoaded&&(t._glTextures[i.id]=i.createTexture(),i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===n.BaseTexture.SCALE_MODE.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===n.BaseTexture.SCALE_MODE.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null))};n.updateWebGLTexture=function(t,i){t._glTextures[i.id]&&(i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.scaleMode===n.BaseTexture.SCALE_MODE.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t.scaleMode===n.BaseTexture.SCALE_MODE.LINEAR?i.LINEAR:i.NEAREST),t._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null))};n.WebGLRenderer.prototype.handleContextLost=function(n){n.preventDefault();this.contextLost=!0};n.WebGLRenderer.prototype.handleContextRestored=function(){var t,i,r;try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(u){try{this.gl=this.view.getContext("webgl",this.options)}catch(f){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this);}}t=this.gl;t.id=n.WebGLRenderer.glContextId++;this.shaderManager.setContext(t);this.spriteBatch.setContext(t);this.maskManager.setContext(t);this.filterManager.setContext(t);this.renderSession.gl=this.gl;t.disable(t.DEPTH_TEST);t.disable(t.CULL_FACE);t.enable(t.BLEND);t.colorMask(!0,!0,!0,this.transparent);this.gl.viewport(0,0,this.width,this.height);for(i in n.TextureCache)r=n.TextureCache[i].baseTexture,r._glTextures=[];this.contextLost=!1};n.WebGLRenderer.glContextId=0;n.WebGLMaskManager=function(n){this.maskStack=[];this.maskPosition=0;this.setContext(n)};n.WebGLMaskManager.prototype.setContext=function(n){this.gl=n};n.WebGLMaskManager.prototype.pushMask=function(t,i){var r=this.gl;this.maskStack.length===0&&(r.enable(r.STENCIL_TEST),r.stencilFunc(r.ALWAYS,1,1));this.maskStack.push(t);r.colorMask(!1,!1,!1,!1);r.stencilOp(r.KEEP,r.KEEP,r.INCR);n.WebGLGraphics.renderGraphics(t,i);r.colorMask(!0,!0,!0,!0);r.stencilFunc(r.NOTEQUAL,0,this.maskStack.length);r.stencilOp(r.KEEP,r.KEEP,r.KEEP)};n.WebGLMaskManager.prototype.popMask=function(t){var i=this.gl,r=this.maskStack.pop();r&&(i.colorMask(!1,!1,!1,!1),i.stencilOp(i.KEEP,i.KEEP,i.DECR),n.WebGLGraphics.renderGraphics(r,t),i.colorMask(!0,!0,!0,!0),i.stencilFunc(i.NOTEQUAL,0,this.maskStack.length),i.stencilOp(i.KEEP,i.KEEP,i.KEEP));this.maskStack.length===0&&i.disable(i.STENCIL_TEST)};n.WebGLShaderManager=function(n){this.setContext(n)};n.WebGLShaderManager.prototype.setContext=function(t){this.gl=t;this.primitiveShader=new n.PrimitiveShader(t);this.defaultShader=new n.PixiShader(t);var i=this.defaultShader.program;t.useProgram(i);t.enableVertexAttribArray(this.defaultShader.aVertexPosition);t.enableVertexAttribArray(this.defaultShader.colorAttribute);t.enableVertexAttribArray(this.defaultShader.aTextureCoord)};n.WebGLShaderManager.prototype.activatePrimitiveShader=function(){var n=this.gl;n.useProgram(this.primitiveShader.program);n.disableVertexAttribArray(this.defaultShader.aVertexPosition);n.disableVertexAttribArray(this.defaultShader.colorAttribute);n.disableVertexAttribArray(this.defaultShader.aTextureCoord);n.enableVertexAttribArray(this.primitiveShader.aVertexPosition);n.enableVertexAttribArray(this.primitiveShader.colorAttribute)};n.WebGLShaderManager.prototype.deactivatePrimitiveShader=function(){var n=this.gl;n.useProgram(this.defaultShader.program);n.disableVertexAttribArray(this.primitiveShader.aVertexPosition);n.disableVertexAttribArray(this.primitiveShader.colorAttribute);n.enableVertexAttribArray(this.defaultShader.aVertexPosition);n.enableVertexAttribArray(this.defaultShader.colorAttribute);n.enableVertexAttribArray(this.defaultShader.aTextureCoord)};n.WebGLSpriteBatch=function(n){var u,r,t,i;for(this.size=2e3,this.vertSize=6,u=this.size*4*this.vertSize,r=this.size*6,this.vertices=new Float32Array(u),this.indices=new Uint16Array(r),this.lastIndexCount=0,t=0,i=0;t<r;t+=6,i+=4)this.indices[t+0]=i+0,this.indices[t+1]=i+1,this.indices[t+2]=i+2,this.indices[t+3]=i+0,this.indices[t+4]=i+2,this.indices[t+5]=i+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.setContext(n)};n.WebGLSpriteBatch.prototype.setContext=function(n){this.gl=n;this.vertexBuffer=n.createBuffer();this.indexBuffer=n.createBuffer();n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.indices,n.STATIC_DRAW);n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);n.bufferData(n.ARRAY_BUFFER,this.vertices,n.DYNAMIC_DRAW);this.currentBlendMode=99999};n.WebGLSpriteBatch.prototype.begin=function(n){this.renderSession=n;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};n.WebGLSpriteBatch.prototype.end=function(){this.flush()};n.WebGLSpriteBatch.prototype.render=function(n){var r,h;if((n.texture.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=n.texture.baseTexture),n.blendMode!==this.currentBlendMode&&this.setBlendMode(n.blendMode),r=n._uvs||n.texture._uvs,r){var c=n.worldAlpha,l=n.tint,t=this.vertices,k=n.texture.frame.width,d=n.texture.frame.height,g=n.anchor.x,nt=n.anchor.y,e,u,o,f;n.texture.trimmed?(h=n.texture.trim,u=h.x-g*h.realWidth,e=u+k,f=h.y-nt*h.realHeight,o=f+d):(e=k*(1-g),u=k*-g,o=d*(1-nt),f=d*-nt);var i=this.currentBatchSize*4*this.vertSize,s=n.worldTransform,a=s[0],v=s[3],y=s[1],p=s[4],w=s[2],b=s[5];t[i++]=a*u+y*f+w;t[i++]=p*f+v*u+b;t[i++]=r[0];t[i++]=r[1];t[i++]=c;t[i++]=l;t[i++]=a*e+y*f+w;t[i++]=p*f+v*e+b;t[i++]=r[2];t[i++]=r[3];t[i++]=c;t[i++]=l;t[i++]=a*e+y*o+w;t[i++]=p*o+v*e+b;t[i++]=r[4];t[i++]=r[5];t[i++]=c;t[i++]=l;t[i++]=a*u+y*o+w;t[i++]=p*o+v*u+b;t[i++]=r[6];t[i++]=r[7];t[i++]=c;t[i++]=l;this.currentBatchSize++}};n.WebGLSpriteBatch.prototype.renderTilingSprite=function(n){var u=n.tilingTexture;(u.baseTexture!==this.currentBaseTexture||this.currentBatchSize>=this.size)&&(this.flush(),this.currentBaseTexture=u.baseTexture);n.blendMode!==this.currentBlendMode&&this.setBlendMode(n.blendMode);n._uvs||(n._uvs=new Float32Array(8));var r=n._uvs,e=n.tilePosition.x/u.baseTexture.width,o=n.tilePosition.y/u.baseTexture.height,g=n.width/u.baseTexture.width/(n.tileScale.x*n.tileScaleOffset.x),nt=n.height/u.baseTexture.height/(n.tileScale.y*n.tileScaleOffset.y);r[0]=0-e;r[1]=0-o;r[2]=1*g-e;r[3]=0-o;r[4]=1*g-e;r[5]=1*nt-o;r[6]=0-e;r[7]=1*nt-o;var s=n.worldAlpha,h=n.tint,t=this.vertices,tt=n.width,it=n.height,rt=n.anchor.x,ut=n.anchor.y,c=tt*(1-rt),l=tt*-rt,a=it*(1-ut),v=it*-ut,i=this.currentBatchSize*4*this.vertSize,f=n.worldTransform,y=f[0],p=f[3],w=f[1],b=f[4],k=f[2],d=f[5];t[i++]=y*l+w*v+k;t[i++]=b*v+p*l+d;t[i++]=r[0];t[i++]=r[1];t[i++]=s;t[i++]=h;t[i++]=y*c+w*v+k;t[i++]=b*v+p*c+d;t[i++]=r[2];t[i++]=r[3];t[i++]=s;t[i++]=h;t[i++]=y*c+w*a+k;t[i++]=b*a+p*c+d;t[i++]=r[4];t[i++]=r[5];t[i++]=s;t[i++]=h;t[i++]=y*l+w*a+k;t[i++]=b*a+p*l+d;t[i++]=r[6];t[i++]=r[7];t[i++]=s;t[i++]=h;this.currentBatchSize++};n.WebGLSpriteBatch.prototype.flush=function(){var t,i;this.currentBatchSize!==0&&(t=this.gl,t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]||n.createWebGLTexture(this.currentBaseTexture,t)),i=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize),t.bufferSubData(t.ARRAY_BUFFER,0,i),t.drawElements(t.TRIANGLES,this.currentBatchSize*6,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++)};n.WebGLSpriteBatch.prototype.stop=function(){this.flush()};n.WebGLSpriteBatch.prototype.start=function(){var t=this.gl,r,i;t.activeTexture(t.TEXTURE0);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);r=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,r.x,r.y);i=this.vertSize*4;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,i,0);t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,i,8);t.vertexAttribPointer(this.shader.colorAttribute,2,t.FLOAT,!1,i,16);this.currentBlendMode!==n.blendModes.NORMAL&&this.setBlendMode(n.blendModes.NORMAL)};n.WebGLSpriteBatch.prototype.setBlendMode=function(t){this.flush();this.currentBlendMode=t;var i=n.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(i[0],i[1])};n.WebGLFilterManager=function(n,t){this.transparent=t;this.filterStack=[];this.offsetX=0;this.offsetY=0;this.setContext(n)};n.WebGLFilterManager.prototype.setContext=function(n){this.gl=n;this.texturePool=[];this.initShaderBuffers()};n.WebGLFilterManager.prototype.begin=function(n,t){this.renderSession=n;this.defaultShader=n.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=i.x*2;this.height=-i.y*2;this.buffer=t};n.WebGLFilterManager.prototype.pushFilter=function(t){var r=this.gl,e=this.renderSession.projection,o=this.renderSession.offset,s,u,i,f;this.filterStack.push(t);s=t.filterPasses[0];this.offsetX+=t.target.filterArea.x;this.offsetY+=t.target.filterArea.y;u=this.texturePool.pop();u?u.resize(this.width,this.height):u=new n.FilterTexture(this.gl,this.width,this.height);r.bindTexture(r.TEXTURE_2D,u.texture);t.target.filterArea=t.target.getBounds();i=t.target.filterArea;f=s.padding;i.x-=f;i.y-=f;i.width+=f*2;i.height+=f*2;i.x<0&&(i.x=0);i.width>this.width&&(i.width=this.width);i.y<0&&(i.y=0);i.height>this.height&&(i.height=this.height);r.bindFramebuffer(r.FRAMEBUFFER,u.frameBuffer);r.viewport(0,0,i.width,i.height);e.x=i.width/2;e.y=-i.height/2;o.x=-i.x;o.y=-i.y;r.uniform2f(this.defaultShader.projectionVector,i.width/2,-i.height/2);r.uniform2f(this.defaultShader.offsetVector,-i.x,-i.y);r.colorMask(!0,!0,!0,!0);r.clearColor(0,0,0,0);r.clear(r.COLOR_BUFFER_BIT);t._glFilterTexture=u};n.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,r=this.filterStack.pop(),i=r.target.filterArea,c=r._glFilterTexture,p=this.renderSession.projection,w=this.renderSession.offset,f,u,l,b,k,d,y,s,h;if(r.filterPasses.length>1){for(t.viewport(0,0,i.width,i.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=i.height,this.vertexArray[2]=i.width,this.vertexArray[3]=i.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=i.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=i.width/this.width,this.uvArray[5]=i.height/this.height,this.uvArray[6]=i.width/this.width,this.uvArray[7]=i.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),f=c,u=this.texturePool.pop(),u||(u=new n.FilterTexture(this.gl,this.width,this.height)),t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND),l=0;l<r.filterPasses.length-1;l++)b=r.filterPasses[l],t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,f.texture),this.applyFilterPass(b,i,i.width,i.height),k=f,f=u,u=k;t.enable(t.BLEND);c=f;this.texturePool.push(u)}d=r.filterPasses[r.filterPasses.length-1];this.offsetX-=i.x;this.offsetY-=i.y;var e=this.width,o=this.height,a=0,v=0,g=this.buffer;this.filterStack.length===0?t.colorMask(!0,!0,!0,this.transparent):(y=this.filterStack[this.filterStack.length-1],i=y.target.filterArea,e=i.width,o=i.height,a=i.x,v=i.y,g=y._glFilterTexture.frameBuffer);p.x=e/2;p.y=-o/2;w.x=a;w.y=v;i=r.target.filterArea;s=i.x-a;h=i.y-v;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=s;this.vertexArray[1]=h+i.height;this.vertexArray[2]=s+i.width;this.vertexArray[3]=h+i.height;this.vertexArray[4]=s;this.vertexArray[5]=h;this.vertexArray[6]=s+i.width;this.vertexArray[7]=h;t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray);t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=i.width/this.width;this.uvArray[5]=i.height/this.height;this.uvArray[6]=i.width/this.width;this.uvArray[7]=i.height/this.height;t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);t.viewport(0,0,e,o);t.bindFramebuffer(t.FRAMEBUFFER,g);t.activeTexture(t.TEXTURE0);t.bindTexture(t.TEXTURE_2D,c.texture);this.applyFilterPass(d,i,e,o);t.useProgram(this.defaultShader.program);t.uniform2f(this.defaultShader.projectionVector,e/2,-o/2);t.uniform2f(this.defaultShader.offsetVector,-a,-v);this.texturePool.push(c);r._glFilterTexture=null};n.WebGLFilterManager.prototype.applyFilterPass=function(t,i,r,u){var f=this.gl,e=t.shaders[f.id];e||(e=new n.PixiShader(f),e.fragmentSrc=t.fragmentSrc,e.uniforms=t.uniforms,e.init(),t.shaders[f.id]=e);f.useProgram(e.program);f.uniform2f(e.projectionVector,r/2,-u/2);f.uniform2f(e.offsetVector,0,0);t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]);e.syncUniforms();f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.vertexAttribPointer(e.aVertexPosition,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);f.vertexAttribPointer(e.aTextureCoord,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);f.vertexAttribPointer(e.colorAttribute,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);this.renderSession.drawCount++};n.WebGLFilterManager.prototype.initShaderBuffers=function(){var n=this.gl;this.vertexBuffer=n.createBuffer();this.uvBuffer=n.createBuffer();this.colorBuffer=n.createBuffer();this.indexBuffer=n.createBuffer();this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]);n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);n.bufferData(n.ARRAY_BUFFER,this.vertexArray,n.STATIC_DRAW);this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]);n.bindBuffer(n.ARRAY_BUFFER,this.uvBuffer);n.bufferData(n.ARRAY_BUFFER,this.uvArray,n.STATIC_DRAW);this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer);n.bufferData(n.ARRAY_BUFFER,this.colorArray,n.STATIC_DRAW);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),n.STATIC_DRAW)};n.FilterTexture=function(n,t,i){this.gl=n;this.frameBuffer=n.createFramebuffer();this.texture=n.createTexture();n.bindTexture(n.TEXTURE_2D,this.texture);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer);n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture,0);this.resize(t,i)};n.FilterTexture.prototype.clear=function(){var n=this.gl;n.clearColor(0,0,0,0);n.clear(n.COLOR_BUFFER_BIT)};n.FilterTexture.prototype.resize=function(n,t){if(this.width!==n||this.height!==t){this.width=n;this.height=t;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,n,t,0,i.RGBA,i.UNSIGNED_BYTE,null)}};n.CanvasMaskManager=function(){};n.CanvasMaskManager.prototype.pushMask=function(t,i){i.save();var u=t.alpha,r=t.worldTransform;i.setTransform(r[0],r[3],r[1],r[4],r[2],r[5]);n.CanvasGraphics.renderGraphicsMask(t,i);i.clip();t.worldAlpha=u};n.CanvasMaskManager.prototype.popMask=function(n){n.restore()};n.CanvasTinter=function(){};n.CanvasTinter.getTintedTexture=function(t,i){var r=t.texture,u,f,e;return(i=n.CanvasTinter.roundColor(i),u="#"+("00000"+(i|0).toString(16)).substr(-6),r.tintCache=r.tintCache||{},r.tintCache[u])?r.tintCache[u]:(f=n.CanvasTinter.canvas||document.createElement("canvas"),n.CanvasTinter.tintMethod(r,i,f),n.CanvasTinter.convertTintToImage?(e=new Image,e.src=f.toDataURL(),r.tintCache[u]=e):(r.tintCache[u]=f,n.CanvasTinter.canvas=null),f)};n.CanvasTinter.tintWithMultiply=function(n,t,i){var u=i.getContext("2d"),r=n.frame;i.width=r.width;i.height=r.height;u.fillStyle="#"+("00000"+(t|0).toString(16)).substr(-6);u.fillRect(0,0,r.width,r.height);u.globalCompositeOperation="multiply";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);u.globalCompositeOperation="destination-atop";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)};n.CanvasTinter.tintWithOverlay=function(n,t,i){var u=i.getContext("2d"),r=n.frame;i.width=r.width;i.height=r.height;u.globalCompositeOperation="copy";u.fillStyle="#"+("00000"+(t|0).toString(16)).substr(-6);u.fillRect(0,0,r.width,r.height);u.globalCompositeOperation="destination-atop";u.drawImage(n.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)};n.CanvasTinter.tintWithPerPixel=function(t,i,r){var e=r.getContext("2d"),u=t.frame,f;r.width=u.width;r.height=u.height;e.globalCompositeOperation="copy";e.drawImage(t.baseTexture.source,u.x,u.y,u.width,u.height,0,0,u.width,u.height);var s=n.hex2rgb(i),c=s[0],l=s[1],a=s[2],h=e.getImageData(0,0,u.width,u.height),o=h.data;for(f=0;f<o.length;f+=4)o[f+0]*=c,o[f+1]*=l,o[f+2]*=a;e.putImageData(h,0,0)};n.CanvasTinter.roundColor=function(t){var r=n.CanvasTinter.cacheStepsPerColorChannel,i=n.hex2rgb(t);return i[0]=Math.round(i[0]*r)/r,i[1]=Math.round(i[1]*r)/r,i[2]=Math.round(i[2]*r)/r,n.rgb2hex(i)};n.CanvasTinter.cacheStepsPerColorChannel=8;n.CanvasTinter.convertTintToImage=!1;n.CanvasTinter.canUseMultiply=n.canUseNewCanvasBlendModes();n.CanvasTinter.tintMethod=n.CanvasTinter.canUseMultiply?n.CanvasTinter.tintWithMultiply:n.CanvasTinter.tintWithPerPixel;n.CanvasRenderer=function(t,i,r,u){n.defaultRenderer=n.defaultRenderer||this;this.type=n.CANVAS_RENDERER;this.transparent=u;n.blendModesCanvas||(n.blendModesCanvas=[],n.canUseNewCanvasBlendModes()?(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="multiply",n.blendModesCanvas[n.blendModes.SCREEN]="screen"):(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="source-over",n.blendModesCanvas[n.blendModes.SCREEN]="source-over"));this.width=t||800;this.height=i||600;this.view=r||document.createElement("canvas");this.context=this.view.getContext("2d");this.smoothProperty=null;"imageSmoothingEnabled"in this.context?this.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.smoothProperty="oImageSmoothingEnabled");this.scaleMode=null;this.refresh=!0;this.view.width=this.width;this.view.height=this.height;this.count=0;this.maskManager=new n.CanvasMaskManager;this.renderSession={};this.renderSession.context=this.context;this.renderSession.maskManager=this.maskManager};n.CanvasRenderer.prototype.constructor=n.CanvasRenderer;n.CanvasRenderer.prototype.render=function(t){n.texturesToUpdate=[];n.texturesToDestroy=[];n.visibleCount++;t.updateTransform();this.view.style.backgroundColor===t.backgroundColorString||this.transparent||(this.view.style.backgroundColor=t.backgroundColorString);this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height);this.renderDisplayObject(t);t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)));n.Texture.frameUpdates.length>0&&(n.Texture.frameUpdates=[])};n.CanvasRenderer.prototype.resize=function(n,t){this.width=n;this.height=t;this.view.width=n;this.view.height=t};n.CanvasRenderer.prototype.renderDisplayObject=function(n,t){this.renderSession.context=t||this.context;n._renderCanvas(this.renderSession)};n.CanvasRenderer.prototype.renderStripFlat=function(n){var t=this.context,i=n.verticies,f=i.length/2,u;for(this.count++,t.beginPath(),u=1;u<f-2;u++){var r=u*2,e=i[r],o=i[r+2],s=i[r+4],h=i[r+1],c=i[r+3],l=i[r+5];t.moveTo(e,h);t.lineTo(o,c);t.lineTo(s,l)}t.fillStyle="#FF0000";t.fill();t.closePath()};n.CanvasRenderer.prototype.renderStrip=function(n){var i=this.context,h=n.verticies,w=n.uvs,d=h.length/2,k;for(this.count++,k=1;k<d-2;k++){var t=k*2,c=h[t],l=h[t+2],a=h[t+4],v=h[t+1],y=h[t+3],p=h[t+5],r=w[t]*n.texture.width,u=w[t+2]*n.texture.width,f=w[t+4]*n.texture.width,e=w[t+1]*n.texture.height,o=w[t+3]*n.texture.height,s=w[t+5]*n.texture.height;i.save();i.beginPath();i.moveTo(c,v);i.lineTo(l,y);i.lineTo(a,p);i.closePath();i.clip();var b=r*o+e*f+u*s-o*f-e*u-r*s,g=c*o+e*a+l*s-o*a-e*l-c*s,nt=r*l+c*f+u*a-l*f-c*u-r*a,tt=r*o*a+e*l*f+c*u*s-c*o*f-e*u*a-r*l*s,it=v*o+e*p+y*s-o*p-e*y-v*s,rt=r*y+v*f+u*p-y*f-v*u-r*p,ut=r*o*p+e*y*f+v*u*s-v*o*f-e*u*p-r*y*s;i.transform(g/b,it/b,nt/b,rt/b,tt/b,ut/b);i.drawImage(n.texture.baseTexture.source,0,0);i.restore()}};n.CanvasBuffer=function(n,t){this.width=n;this.height=t;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=n;this.canvas.height=t};n.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};n.CanvasBuffer.prototype.resize=function(n,t){this.width=this.canvas.width=n;this.height=this.canvas.height=t};n.CanvasGraphics=function(){};n.CanvasGraphics.renderGraphics=function(t,i){for(var r,u,c,f=t.worldAlpha,h="",b=0;b<t.graphicsData.length;b++)if(r=t.graphicsData[b],u=r.points,i.strokeStyle=h="#"+("00000"+(r.lineColor|0).toString(16)).substr(-6),i.lineWidth=r.lineWidth,r.type===n.Graphics.POLY){for(i.beginPath(),i.moveTo(u[0],u[1]),c=1;c<u.length/2;c++)i.lineTo(u[c*2],u[c*2+1]);u[0]===u[u.length-2]&&u[1]===u[u.length-1]&&i.closePath();r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=h="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill());r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke())}else if(r.type===n.Graphics.RECT)(r.fillColor||r.fillColor===0)&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=h="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fillRect(u[0],u[1],u[2],u[3])),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.strokeRect(u[0],u[1],u[2],u[3]));else if(r.type===n.Graphics.CIRC)i.beginPath(),i.arc(u[0],u[1],u[2],0,2*Math.PI),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=h="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke());else if(r.type===n.Graphics.ELIP){var a=r.points,v=a[2]*2,y=a[3]*2,o=a[0]-v/2,l=a[1]-y/2;i.beginPath();var g=.5522848,p=v/2*g,w=y/2*g,k=o+v,d=l+y,s=o+v/2,e=l+y/2;i.moveTo(o,e);i.bezierCurveTo(o,e-w,s-p,l,s,l);i.bezierCurveTo(s+p,l,k,e-w,k,e);i.bezierCurveTo(k,e+w,s+p,d,s,d);i.bezierCurveTo(s-p,d,o,e+w,o,e);i.closePath();r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=h="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill());r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke())}};n.CanvasGraphics.renderGraphicsMask=function(t,i){var w=t.graphicsData.length,c,u,r,s;if(w!==0)for(w>1&&(w=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object")),c=0;c<1;c++)if(u=t.graphicsData[c],r=u.points,u.type===n.Graphics.POLY){for(i.beginPath(),i.moveTo(r[0],r[1]),s=1;s<r.length/2;s++)i.lineTo(r[s*2],r[s*2+1]);r[0]===r[r.length-2]&&r[1]===r[r.length-1]&&i.closePath()}else if(u.type===n.Graphics.RECT)i.beginPath(),i.rect(r[0],r[1],r[2],r[3]),i.closePath();else if(u.type===n.Graphics.CIRC)i.beginPath(),i.arc(r[0],r[1],r[2],0,2*Math.PI),i.closePath();else if(u.type===n.Graphics.ELIP){var l=u.points,a=l[2]*2,v=l[3]*2,e=l[0]-a/2,h=l[1]-v/2;i.beginPath();var d=.5522848,y=a/2*d,p=v/2*d,b=e+a,k=h+v,o=e+a/2,f=h+v/2;i.moveTo(e,f);i.bezierCurveTo(e,f-p,o-y,h,o,h);i.bezierCurveTo(o+y,h,b,f-p,b,f);i.bezierCurveTo(b,f+p,o+y,k,o,k);i.bezierCurveTo(o-y,k,e,f+p,e,f);i.closePath()}};n.Graphics=function(){n.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineWidth=0;this.lineColor="black";this.graphicsData=[];this.tint=16777215;this.blendMode=n.blendModes.NORMAL;this.currentPath={points:[]};this._webGL=[];this.isMask=!1};n.Graphics.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Graphics.prototype.constructor=n.Graphics;Object.defineProperty(n.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(n){this._cacheAsBitmap=n}});n.Graphics.prototype.lineStyle=function(t,i,r){this.currentPath.points.length||this.graphicsData.pop();this.lineWidth=t||0;this.lineColor=i||0;this.lineAlpha=arguments.length<3?1:r;this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:n.Graphics.POLY};this.graphicsData.push(this.currentPath)};n.Graphics.prototype.moveTo=function(t,i){this.currentPath.points.length||this.graphicsData.pop();this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:n.Graphics.POLY};this.currentPath.points.push(t,i);this.graphicsData.push(this.currentPath)};n.Graphics.prototype.lineTo=function(n,t){this.currentPath.points.push(n,t);this.dirty=!0};n.Graphics.prototype.beginFill=function(n,t){this.filling=!0;this.fillColor=n||0;this.fillAlpha=arguments.length<2?1:t};n.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1};n.Graphics.prototype.drawRect=function(t,i,r,u){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,u],type:n.Graphics.RECT};this.graphicsData.push(this.currentPath);this.dirty=!0};n.Graphics.prototype.drawCircle=function(t,i,r){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,r],type:n.Graphics.CIRC};this.graphicsData.push(this.currentPath);this.dirty=!0};n.Graphics.prototype.drawEllipse=function(t,i,r,u){this.currentPath.points.length||this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[t,i,r,u],type:n.Graphics.ELIP};this.graphicsData.push(this.currentPath);this.dirty=!0};n.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.dirty=!0;this.clearDirty=!0;this.graphicsData=[];this.bounds=null};n.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&this.alpha!==0&&this.isMask!==!0){if(t.spriteBatch.stop(),this._mask&&t.maskManager.pushMask(this.mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){this.spriteBatch.currentBlendMode=this.blendMode;var i=n.blendModesWebGL[t.spriteBatch.currentBlendMode];this.spriteBatch.gl.blendFunc(i[0],i[1])}n.WebGLGraphics.renderGraphics(this,t);this._filters&&t.filterManager.popFilter();this._mask&&t.maskManager.popMask(t);t.drawCount++;t.spriteBatch.start()}};n.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&this.alpha!==0&&this.isMask!==!0){var r=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,r.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]);r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]);n.CanvasGraphics.renderGraphics(this,r)}};n.Graphics.prototype.getBounds=function(){var f;this.bounds||this.updateBounds();var e=this.bounds.x,o=this.bounds.width+this.bounds.x,s=this.bounds.y,h=this.bounds.height+this.bounds.y,u=this.worldTransform,c=u[0],l=u[3],a=u[1],v=u[4],y=u[2],p=u[5],w=c*o+a*h+y,b=v*h+l*o+p,k=c*e+a*h+y,d=v*h+l*e+p,g=c*e+a*s+y,nt=v*s+l*e+p,tt=c*o+a*s+y,it=v*s+l*o+p,i=-Infinity,r=-Infinity,n=Infinity,t=Infinity;return n=w<n?w:n,n=k<n?k:n,n=g<n?g:n,n=tt<n?tt:n,t=b<t?b:t,t=d<t?d:t,t=nt<t?nt:t,t=it<t?it:t,i=w>i?w:i,i=k>i?k:i,i=g>i?g:i,i=tt>i?tt:i,r=b>r?b:r,r=d>r?d:r,r=nt>r?nt:r,r=it>r?it:r,f=this._bounds,f.x=n,f.width=i-n,f.y=t,f.height=r-t,f};n.Graphics.prototype.updateBounds=function(){for(var y,p,h,c,u=Infinity,o=-Infinity,f=Infinity,s=-Infinity,e,t,i,l=0;l<this.graphicsData.length;l++){var a=this.graphicsData[l],v=a.type,r=a.lineWidth;if(e=a.points,v===n.Graphics.RECT)t=e.x-r/2,i=e.y-r/2,y=e.width+r,p=e.height+r,u=t<u?t:u,o=t+y>o?t+y:o,f=i<f?t:f,s=i+p>s?i+p:s;else if(v===n.Graphics.CIRC||v===n.Graphics.ELIP)t=e.x,i=e.y,h=e.radius+r/2,u=t-h<u?t-h:u,o=t+h>o?t+h:o,f=i-h<f?i-h:f,s=i+h>s?i+h:s;else for(c=0;c<e.length;c+=2)t=e[c],i=e[c+1],u=t-r<u?t-r:u,o=t+r>o?t+r:o,f=i-r<f?i-r:f,s=i+r>s?i+r:s}this.bounds=new n.Rectangle(u,f,o-u,s-f)};n.Graphics.POLY=0;n.Graphics.RECT=1;n.Graphics.CIRC=2;n.Graphics.ELIP=3;n.Strip=function(t,i,r){n.DisplayObjectContainer.call(this);this.texture=t;this.blendMode=n.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]);this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]);this.colors=new Float32Array([1,1,1,1]);this.indices=new Uint16Array([0,1,2,3])}catch(u){this.uvs=[0,1,1,1,1,0,0,1];this.verticies=[0,0,0,0,0,0,0,0,0];this.colors=[1,1,1,1];this.indices=[0,1,2,3]}this.width=i;this.height=r;t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));this.renderable=!0};n.Strip.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Strip.prototype.constructor=n.Strip;n.Strip.prototype.setTexture=function(n){this.texture=n;this.width=n.frame.width;this.height=n.frame.height;this.updateFrame=!0};n.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0};n.Rope=function(t,i){n.Strip.call(this,t);this.points=i;try{this.verticies=new Float32Array(i.length*4);this.uvs=new Float32Array(i.length*4);this.colors=new Float32Array(i.length*2);this.indices=new Uint16Array(i.length*2)}catch(r){this.verticies=new Array(i.length*4);this.uvs=new Array(i.length*4);this.colors=new Array(i.length*2);this.indices=new Array(i.length*2)}this.refresh()};n.Rope.prototype=Object.create(n.Strip.prototype);n.Rope.prototype.constructor=n.Rope;n.Rope.prototype.refresh=function(){var u=this.points,o,s,n,r,i;if(!(u.length<1)){var t=this.uvs,h=u[0],f=this.indices,e=this.colors;for(this.count-=.2,t[0]=0,t[1]=1,t[2]=0,t[3]=1,e[0]=1,e[1]=1,f[0]=0,f[1]=1,o=u.length,i=1;i<o;i++)s=u[i],n=i*4,r=i/(o-1),i%2?(t[n]=r,t[n+1]=0,t[n+2]=r,t[n+3]=1):(t[n]=r,t[n+1]=0,t[n+2]=r,t[n+3]=1),n=i*2,e[n]=1,e[n+1]=1,n=i*2,f[n]=n,f[n+1]=n+1,h=s}};n.Rope.prototype.updateTransform=function(){var e=this.points,r,s,t,i,h,f,o,c,l,a,u;if(!(e.length<1)){for(r=e[0],t={x:0,y:0},this.count-=.2,i=this.verticies,i[0]=r.x+t.x,i[1]=r.y+t.y,i[2]=r.x-t.x,i[3]=r.y-t.y,h=e.length,u=1;u<h;u++)f=e[u],o=u*4,s=u<e.length-1?e[u+1]:f,t.y=-(s.x-r.x),t.x=s.y-r.y,c=(1-u/(h-1))*10,c>1&&(c=1),l=Math.sqrt(t.x*t.x+t.y*t.y),a=this.texture.height/2,t.x/=l,t.y/=l,t.x*=a,t.y*=a,i[o]=f.x+t.x,i[o+1]=f.y+t.y,i[o+2]=f.x-t.x,i[o+3]=f.y-t.y,r=f;n.DisplayObjectContainer.prototype.updateTransform.call(this)}};n.Rope.prototype.setTexture=function(n){this.texture=n;this.updateFrame=!0};n.TilingSprite=function(t,i,r){n.Sprite.call(this,t);this.width=i||100;this.height=r||100;this.tileScale=new n.Point(1,1);this.tileScaleOffset=new n.Point(1,1);this.tilePosition=new n.Point(0,0);this.renderable=!0;this.tint=16777215;this.blendMode=n.blendModes.NORMAL};n.TilingSprite.prototype=Object.create(n.Sprite.prototype);n.TilingSprite.prototype.constructor=n.TilingSprite;Object.defineProperty(n.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(n){this._width=n}});Object.defineProperty(n.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(n){this._height=n}});n.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0};n.TilingSprite.prototype._renderWebGL=function(n){if(this.visible!==!1&&this.alpha!==0){var t,i;if(this.mask||this.filters){for(this.mask&&(n.spriteBatch.stop(),n.maskManager.pushMask(this.mask,n.projection),n.spriteBatch.start()),this.filters&&(n.spriteBatch.flush(),n.filterManager.pushFilter(this._filterBlock)),this.tilingTexture?n.spriteBatch.renderTilingSprite(this):this.generateTilingTexture(!0),t=0,i=this.children.length;t<i;t++)this.children[t]._renderWebGL(n);n.spriteBatch.stop();this.filters&&n.filterManager.popFilter();this.mask&&n.maskManager.popMask(n.projection);n.spriteBatch.start()}else for(this.tilingTexture?n.spriteBatch.renderTilingSprite(this):this.generateTilingTexture(!0),t=0,i=this.children.length;t<i;t++)this.children[t]._renderWebGL(n)}};n.TilingSprite.prototype._renderCanvas=function(t){var i,r,u,f;this.visible!==!1&&this.alpha!==0&&(i=t.context,i.globalAlpha=this.worldAlpha,r=this.worldTransform,i.setTransform(r[0],r[3],r[1],r[4],r[2],r[5]),this.__tilePattern||(this.generateTilingTexture(!1),this.tilingTexture&&(this.__tilePattern=i.createPattern(this.tilingTexture.baseTexture.source,"repeat"))),this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),i.beginPath(),u=this.tilePosition,f=this.tileScale,i.scale(f.x,f.y),i.translate(u.x,u.y),i.fillStyle=this.__tilePattern,i.fillRect(-u.x,-u.y,this.width/f.x,this.height/f.y),i.scale(1/f.x,1/f.y),i.translate(-u.x,-u.y),i.closePath())};n.TilingSprite.prototype.getBounds=function(){var rt=this._width,ut=this._height,e=rt*(1-this.anchor.x),o=rt*-this.anchor.x,s=ut*(1-this.anchor.y),h=ut*-this.anchor.y,f=this.worldTransform,c=f[0],l=f[3],a=f[1],v=f[4],y=f[2],p=f[5],w=c*o+a*h+y,b=v*h+l*o+p,k=c*e+a*h+y,d=v*h+l*e+p,g=c*e+a*s+y,nt=v*s+l*e+p,tt=c*o+a*s+y,it=v*s+l*o+p,i=-Infinity,r=-Infinity,n=Infinity,t=Infinity,u;return n=w<n?w:n,n=k<n?k:n,n=g<n?g:n,n=tt<n?tt:n,t=b<t?b:t,t=d<t?d:t,t=nt<t?nt:t,t=it<t?it:t,i=w>i?w:i,i=k>i?k:i,i=g>i?g:i,i=tt>i?tt:i,r=b>r?b:r,r=d>r?d:r,r=nt>r?nt:r,r=it>r?it:r,u=this._bounds,u.x=n,u.width=i-n,u.y=t,u.height=r-t,this._currentBounds=u,u};n.TilingSprite.prototype.generateTilingTexture=function(t){var r=this.texture,e,o;if(r.baseTexture.hasLoaded){var s=r.baseTexture,i=r.frame,u,f,h=i.width!==s.width||i.height!==s.height;this.tilingTexture=r;e=!1;t?(u=n.getNextPowerOfTwo(r.frame.width),f=n.getNextPowerOfTwo(r.frame.height),i.width!==u&&i.height!==f&&(e=!0)):h&&(u=i.width,f=i.height,e=!0);e&&(o=new n.CanvasBuffer(u,f),o.context.drawImage(r.baseTexture.source,i.x,i.y,i.width,i.height,0,0,u,f),this.tilingTexture=n.Texture.fromCanvas(o.canvas),this.tileScaleOffset.x=i.width/u,this.tileScaleOffset.y=i.height/f);this.tilingTexture.baseTexture._powerOf2=!0}};t={};t.BoneData=function(n,t){this.name=n;this.parent=t};t.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1};t.SlotData=function(n,t){this.name=n;this.boneData=t};t.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null};t.Bone=function(n,t){this.data=n;this.parent=t;this.setToSetupPose()};t.Bone.yDown=!1;t.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(n,i){var r=this.parent;r!=null?(this.worldX=this.x*r.m00+this.y*r.m01+r.worldX,this.worldY=this.x*r.m10+this.y*r.m11+r.worldY,this.worldScaleX=r.worldScaleX*this.scaleX,this.worldScaleY=r.worldScaleY*this.scaleY,this.worldRotation=r.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var u=this.worldRotation*Math.PI/180,f=Math.cos(u),e=Math.sin(u);this.m00=f*this.worldScaleX;this.m10=e*this.worldScaleX;this.m01=-e*this.worldScaleY;this.m11=f*this.worldScaleY;n&&(this.m00=-this.m00,this.m01=-this.m01);i&&(this.m10=-this.m10,this.m11=-this.m11);t.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var n=this.data;this.x=n.x;this.y=n.y;this.rotation=n.rotation;this.scaleX=n.scaleX;this.scaleY=n.scaleY}};t.Slot=function(n,t,i){this.data=n;this.skeleton=t;this.bone=i;this.setToSetupPose()};t.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(n){this.attachment=n;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(n){this._attachmentTime=this.skeleton.time-n},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var n=this.data,i,t,r;for(this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,i=this.skeleton.data.slots,t=0,r=i.length;t<r;t++)if(i[t]==n){this.setAttachment(n.attachmentName?this.skeleton.getAttachmentBySlotIndex(t,n.attachmentName):null);break}}};t.Skin=function(n){this.name=n;this.attachments={}};t.Skin.prototype={addAttachment:function(n,t,i){this.attachments[n+":"+t]=i},getAttachment:function(n,t){return this.attachments[n+":"+t]},_attachAll:function(n,t){var i,u;for(i in t.attachments){var f=i.indexOf(":"),e=parseInt(i.substring(0,f),10),o=i.substring(f+1),r=n.slots[e];r.attachment&&r.attachment.name==o&&(u=this.getAttachment(e,o),u&&r.setAttachment(u))}}};t.Animation=function(n,t,i){this.name=n;this.timelines=t;this.duration=i};t.Animation.prototype={apply:function(n,t,i){var u,r,f;for(i&&this.duration&&(t%=this.duration),u=this.timelines,r=0,f=u.length;r<f;r++)u[r].apply(n,t,1)},mix:function(n,t,i,r){var f,u,e;for(i&&this.duration&&(t%=this.duration),f=this.timelines,u=0,e=f.length;u<e;u++)f[u].apply(n,t,r)}};t.binarySearch=function(n,t,i){var f=0,r=Math.floor(n.length/i)-2,u;if(!r)return i;for(u=r>>>1;;){if(n[(u+1)*i]<=t?f=u+1:r=u,f==r)return(f+1)*i;u=f+r>>>1}};t.linearSearch=function(n,t,i){for(var r=0,u=n.length-i;r<=u;r+=i)if(n[r]>t)return r;return-1};t.Curves=function(n){this.curves=[];this.curves.length=(n-1)*6};t.Curves.prototype={setLinear:function(n){this.curves[n*6]=0},setStepped:function(n){this.curves[n*6]=-1},setCurve:function(n,t,i,r,u){var o=1/10,h=o*o,c=h*o,v=3*o,y=3*h,p=6*h,s=6*c,w=-t*2+r,b=-i*2+u,l=(t-r)*3+1,a=(i-u)*3+1,f=n*6,e=this.curves;e[f]=t*v+w*y+l*c;e[f+1]=i*v+b*y+a*c;e[f+2]=w*p+l*s;e[f+3]=b*p+a*s;e[f+4]=l*s;e[f+5]=a*s},getCurvePercent:function(n,t){var s,h;t=t<0?0:t>1?1:t;var i=n*6,r=this.curves,u=r[i];if(!u)return t;if(u==-1)return 0;for(var o=r[i+1],c=r[i+2],l=r[i+3],v=r[i+4],y=r[i+5],f=u,e=o,a=8;;){if(f>=t)return s=f-u,h=e-o,h+(e-h)*(t-s)/(f-s);if(!a)break;a--;u+=c;o+=l;c+=v;l+=y;f+=u;e+=o}return e+(1-e)*(t-f)/(1-f)}};t.RotateTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n*2};t.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(n,t,i){n*=2;this.frames[n]=t;this.frames[n+1]=i},apply:function(n,i,r){var f=this.frames,u,e;if(!(i<f[0])){if(e=n.bones[this.boneIndex],i>=f[f.length-2]){for(u=e.data.rotation+f[f.length-1]-e.rotation;u>180;)u-=360;while(u<-180)u+=360;e.rotation+=u*r;return}var o=t.binarySearch(f,i,2),h=f[o-1],c=f[o],s=1-(i-c)/(f[o-2]-c);for(s=this.curves.getCurvePercent(o/2-1,s),u=f[o+1]-h;u>180;)u-=360;while(u<-180)u+=360;for(u=e.data.rotation+(h+u*s)-e.rotation;u>180;)u-=360;while(u<-180)u+=360;e.rotation+=u*r}}};t.TranslateTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n*3};t.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(n,t,i,r){n*=3;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r},apply:function(n,i,r){var u=this.frames,f;if(!(i<u[0])){if(f=n.bones[this.boneIndex],i>=u[u.length-3]){f.x+=(f.data.x+u[u.length-2]-f.x)*r;f.y+=(f.data.y+u[u.length-1]-f.y)*r;return}var e=t.binarySearch(u,i,3),s=u[e-2],h=u[e-1],c=u[e],o=1-(i-c)/(u[e+-3]-c);o=this.curves.getCurvePercent(e/3-1,o);f.x+=(f.data.x+s+(u[e+1]-s)*o-f.x)*r;f.y+=(f.data.y+h+(u[e+2]-h)*o-f.y)*r}}};t.ScaleTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n*3};t.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(n,t,i,r){n*=3;this.frames[n]=t;this.frames[n+1]=i;this.frames[n+2]=r},apply:function(n,i,r){var u=this.frames,f;if(!(i<u[0])){if(f=n.bones[this.boneIndex],i>=u[u.length-3]){f.scaleX+=(f.data.scaleX-1+u[u.length-2]-f.scaleX)*r;f.scaleY+=(f.data.scaleY-1+u[u.length-1]-f.scaleY)*r;return}var e=t.binarySearch(u,i,3),s=u[e-2],h=u[e-1],c=u[e],o=1-(i-c)/(u[e+-3]-c);o=this.curves.getCurvePercent(e/3-1,o);f.scaleX+=(f.data.scaleX-1+s+(u[e+1]-s)*o-f.scaleX)*r;f.scaleY+=(f.data.scaleY-1+h+(u[e+2]-h)*o-f.scaleY)*r}}};t.ColorTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n*5};t.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(n,t){n*=5;this.frames[n]=t;this.frames[n+1]=r;this.frames[n+2]=g;this.frames[n+3]=b;this.frames[n+4]=a},apply:function(n,i,r){var u=this.frames,f,s;if(!(i<u[0])){if(f=n.slots[this.slotIndex],i>=u[u.length-5]){s=u.length-1;f.r=u[s-3];f.g=u[s-2];f.b=u[s-1];f.a=u[s];return}var e=t.binarySearch(u,i,5),h=u[e-4],c=u[e-3],l=u[e-2],a=u[e-1],v=u[e],o=1-(i-v)/(u[e-5]-v);o=this.curves.getCurvePercent(e/5-1,o);var y=h+(u[e+1]-h)*o,p=c+(u[e+2]-c)*o,w=l+(u[e+3]-l)*o,b=a+(u[e+4]-a)*o;r<1?(f.r+=(y-f.r)*r,f.g+=(p-f.g)*r,f.b+=(w-f.b)*r,f.a+=(b-f.a)*r):(f.r=y,f.g=p,f.b=w,f.a=b)}}};t.AttachmentTimeline=function(n){this.curves=new t.Curves(n);this.frames=[];this.frames.length=n;this.attachmentNames=[];this.attachmentNames.length=n};t.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(n,t,i){this.frames[n]=t;this.attachmentNames[n]=i},apply:function(n,i){var r=this.frames,f,u;i<r[0]||(f=i>=r[r.length-1]?r.length-1:t.binarySearch(r,i,1)-1,u=this.attachmentNames[f],n.slots[this.slotIndex].setAttachment(u?n.getAttachmentBySlotIndex(this.slotIndex,u):null))}};t.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.animations=[]};t.SkeletonData.prototype={defaultSkin:null,findBone:function(n){for(var i=this.bones,t=0,r=i.length;t<r;t++)if(i[t].name==n)return i[t];return null},findBoneIndex:function(n){for(var i=this.bones,t=0,r=i.length;t<r;t++)if(i[t].name==n)return t;return-1},findSlot:function(n){for(var i=this.slots,t=0,r=i.length;t<r;t++)if(i[t].name==n)return slot[t];return null},findSlotIndex:function(n){for(var i=this.slots,t=0,r=i.length;t<r;t++)if(i[t].name==n)return t;return-1},findSkin:function(n){for(var i=this.skins,t=0,r=i.length;t<r;t++)if(i[t].name==n)return i[t];return null},findAnimation:function(n){for(var i=this.animations,t=0,r=i.length;t<r;t++)if(i[t].name==n)return i[t];return null}};t.Skeleton=function(n){var i,r,u,f;for(this.data=n,this.bones=[],i=0,r=n.bones.length;i<r;i++)u=n.bones[i],f=u.parent?this.bones[n.bones.indexOf(u.parent)]:null,this.bones.push(new t.Bone(u,f));for(this.slots=[],this.drawOrder=[],i=0,r=n.slots.length;i<r;i++){var e=n.slots[i],s=this.bones[n.bones.indexOf(e.boneData)],o=new t.Slot(e,this,s);this.slots.push(o);this.drawOrder.push(o)}};t.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var i=this.flipX,r=this.flipY,t=this.bones,n=0,u=t.length;n<u;n++)t[n].updateWorldTransform(i,r)},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,n=0,i=t.length;n<i;n++)t[n].setToSetupPose()},setSlotsToSetupPose:function(){for(var t=this.slots,n=0,i=t.length;n<i;n++)t[n].setToSetupPose(n)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(n){for(var i=this.bones,t=0,r=i.length;t<r;t++)if(i[t].data.name==n)return i[t];return null},findBoneIndex:function(n){for(var i=this.bones,t=0,r=i.length;t<r;t++)if(i[t].data.name==n)return t;return-1},findSlot:function(n){for(var i=this.slots,t=0,r=i.length;t<r;t++)if(i[t].data.name==n)return i[t];return null},findSlotIndex:function(n){for(var i=this.slots,t=0,r=i.length;t<r;t++)if(i[t].data.name==n)return t;return-1},setSkinByName:function(n){var t=this.data.findSkin(n);if(!t)throw"Skin not found: "+n;this.setSkin(t)},setSkin:function(n){this.skin&&n&&n._attachAll(this,this.skin);this.skin=n},getAttachmentBySlotName:function(n,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(n),t)},getAttachmentBySlotIndex:function(n,t){if(this.skin){var i=this.skin.getAttachment(n,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(n,t):null},setAttachment:function(n,t){for(var u,r,f=this.slots,i=0,e=f.size;i<e;i++)if(u=f[i],u.data.name==n){if(r=null,t&&(r=this.getAttachment(i,t),r==null))throw"Attachment not found: "+t+", for slot: "+n;u.setAttachment(r);return}throw"Slot not found: "+n;},update:function(n){time+=n}};t.AttachmentType={region:0};t.RegionAttachment=function(){this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};t.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(n,t,i,r,u){var f=this.uvs;u?(f[2]=n,f[3]=r,f[4]=n,f[5]=t,f[6]=i,f[7]=t,f[0]=i,f[1]=r):(f[0]=n,f[1]=r,f[2]=n,f[3]=t,f[4]=i,f[5]=t,f[6]=i,f[7]=r)},updateOffset:function(){var f=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.regionOffsetX*f,u=-this.height/2*this.scaleY+this.regionOffsetY*e,o=r+this.regionWidth*f,s=u+this.regionHeight*e,h=this.rotation*Math.PI/180,t=Math.cos(h),i=Math.sin(h),c=r*t+this.x,l=r*i,a=u*t+this.y,v=u*i,y=o*t+this.x,p=o*i,w=s*t+this.y,b=s*i,n=this.offset;n[0]=c-v;n[1]=a+l;n[2]=c-b;n[3]=w+l;n[4]=y-b;n[5]=w+p;n[6]=y-v;n[7]=a+p},computeVertices:function(n,t,i,r){n+=i.worldX;t+=i.worldY;var f=i.m00,e=i.m01,o=i.m10,s=i.m11,u=this.offset;r[0]=u[0]*f+u[1]*e+n;r[1]=u[0]*o+u[1]*s+t;r[2]=u[2]*f+u[3]*e+n;r[3]=u[2]*o+u[3]*s+t;r[4]=u[4]*f+u[5]*e+n;r[5]=u[4]*o+u[5]*s+t;r[6]=u[6]*f+u[7]*e+n;r[7]=u[6]*o+u[7]*s+t}};t.AnimationStateData=function(n){this.skeletonData=n;this.animationToMixTime={}};t.AnimationStateData.prototype={defaultMix:0,setMixByName:function(n,t,i){var u=this.skeletonData.findAnimation(n),r;if(!u)throw"Animation not found: "+n;if(r=this.skeletonData.findAnimation(t),!r)throw"Animation not found: "+t;this.setMix(u,r,i)},setMix:function(n,t,i){this.animationToMixTime[n.name+":"+t.name]=i},getMix:function(n,t){var i=this.animationToMixTime[n.name+":"+t.name];return i?i:this.defaultMix}};t.AnimationState=function(n){this.data=n;this.queue=[]};t.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(n){if(this.currentTime+=n,this.previousTime+=n,this.mixTime+=n,this.queue.length>0){var t=this.queue[0];this.currentTime>=t.delay&&(this._setAnimation(t.animation,t.loop),this.queue.shift())}},apply:function(n){if(this.current)if(this.previous){this.previous.apply(n,this.previousTime,this.previousLoop);var t=this.mixTime/this.mixDuration;t>=1&&(t=1,this.previous=null);this.current.mix(n,this.currentTime,this.currentLoop,t)}else this.current.apply(n,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null;this.current=null;this.queue.length=0},_setAnimation:function(n,t){this.previous=null;n&&this.current&&(this.mixDuration=this.data.getMix(this.current,n),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop));this.current=n;this.currentLoop=t;this.currentTime=0},setAnimationByName:function(n,t){var i=this.data.skeletonData.findAnimation(n);if(!i)throw"Animation not found: "+n;this.setAnimation(i,t)},setAnimation:function(n,t){this.queue.length=0;this._setAnimation(n,t)},addAnimationByName:function(n,t,i){var r=this.data.skeletonData.findAnimation(n);if(!r)throw"Animation not found: "+n;this.addAnimation(r,t,i)},addAnimation:function(n,t,i){var r={},u;r.animation=n;r.loop=t;(!i||i<=0)&&(u=this.queue.length?this.queue[this.queue.length-1].animation:this.current,i=u!=null?u.duration-this.data.getMix(u,n)+(i||0):0);r.delay=i;this.queue.push(r)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}};t.SkeletonJson=function(n){this.attachmentLoader=n};t.SkeletonJson.prototype={scale:1,readSkeletonData:function(n){for(var r,l,g,o,e,s,a,v,y,h,p,it,w,c,nt,b,k,u=new t.SkeletonData,i,tt=n.bones,f=0,d=tt.length;f<d;f++){if(r=tt[f],l=null,r.parent&&(l=u.findBone(r.parent),!l))throw"Parent bone not found: "+r.parent;i=new t.BoneData(r.name,l);i.length=(r.length||0)*this.scale;i.x=(r.x||0)*this.scale;i.y=(r.y||0)*this.scale;i.rotation=r.rotation||0;i.scaleX=r.scaleX||1;i.scaleY=r.scaleY||1;u.bones.push(i)}for(g=n.slots,f=0,d=g.length;f<d;f++){if(o=g[f],i=u.findBone(o.bone),!i)throw"Slot bone not found: "+o.bone;e=new t.SlotData(o.name,i);s=o.color;s&&(e.r=t.SkeletonJson.toColor(s,0),e.g=t.SkeletonJson.toColor(s,1),e.b=t.SkeletonJson.toColor(s,2),e.a=t.SkeletonJson.toColor(s,3));e.attachmentName=o.attachment;u.slots.push(e)}a=n.skins;for(v in a)if(a.hasOwnProperty(v)){y=a[v];h=new t.Skin(v);for(p in y)if(y.hasOwnProperty(p)){it=u.findSlotIndex(p);w=y[p];for(c in w)w.hasOwnProperty(c)&&(nt=this.readAttachment(h,c,w[c]),nt!=null&&h.addAttachment(it,c,nt))}u.skins.push(h);h.name=="default"&&(u.defaultSkin=h)}b=n.animations;for(k in b)b.hasOwnProperty(k)&&this.readAnimation(k,b[k],u);return u},readAttachment:function(n,i,r){var f,u;if(i=r.name||i,f=t.AttachmentType[r.type||"region"],f==t.AttachmentType.region)return u=new t.RegionAttachment,u.x=(r.x||0)*this.scale,u.y=(r.y||0)*this.scale,u.scaleX=r.scaleX||1,u.scaleY=r.scaleY||1,u.rotation=r.rotation||0,u.width=(r.width||32)*this.scale,u.height=(r.height||32)*this.scale,u.updateOffset(),u.rendererObject={},u.rendererObject.name=i,u.rendererObject.scale={},u.rendererObject.scale.x=u.scaleX,u.rendererObject.scale.y=u.scaleY,u.rendererObject.rotation=-u.rotation*Math.PI/180,u;throw"Unknown attachment type: "+f;},readAnimation:function(n,i,r){var v=[],c=0,s,u,h,f,o,e,l,nt=i.bones,a,p,w,b,it,rt,k,y,d,tt;for(a in nt)if(nt.hasOwnProperty(a)){if(p=r.findBoneIndex(a),p==-1)throw"Bone not found: "+a;w=nt[a];for(h in w)if(w.hasOwnProperty(h))if(o=w[h],h=="rotate"){for(u=new t.RotateTimeline(o.length),u.boneIndex=p,s=0,e=0,l=o.length;e<l;e++)f=o[e],u.setFrame(s,f.time,f.angle),t.SkeletonJson.readCurve(u,s,f),s++;v.push(u);c=Math.max(c,u.frames[u.getFrameCount()*2-2])}else if(h=="translate"||h=="scale"){for(b=1,h=="scale"?u=new t.ScaleTimeline(o.length):(u=new t.TranslateTimeline(o.length),b=this.scale),u.boneIndex=p,s=0,e=0,l=o.length;e<l;e++)f=o[e],it=(f.x||0)*b,rt=(f.y||0)*b,u.setFrame(s,f.time,it,rt),t.SkeletonJson.readCurve(u,s,f),s++;v.push(u);c=Math.max(c,u.frames[u.getFrameCount()*3-3])}else throw"Invalid timeline type for a bone: "+h+" ("+a+")";}k=i.slots;for(y in k)if(k.hasOwnProperty(y)){d=k[y];tt=r.findSlotIndex(y);for(h in d)if(d.hasOwnProperty(h))if(o=d[h],h=="color"){for(u=new t.ColorTimeline(o.length),u.slotIndex=tt,s=0,e=0,l=o.length;e<l;e++){f=o[e];var g=f.color,ut=t.SkeletonJson.toColor(g,0),ft=t.SkeletonJson.toColor(g,1),et=t.SkeletonJson.toColor(g,2),ot=t.SkeletonJson.toColor(g,3);u.setFrame(s,f.time,ut,ft,et,ot);t.SkeletonJson.readCurve(u,s,f);s++}v.push(u);c=Math.max(c,u.frames[u.getFrameCount()*5-5])}else if(h=="attachment"){for(u=new t.AttachmentTimeline(o.length),u.slotIndex=tt,s=0,e=0,l=o.length;e<l;e++)f=o[e],u.setFrame(s++,f.time,f.name);v.push(u);c=Math.max(c,u.frames[u.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+h+" ("+y+")";}r.animations.push(new t.Animation(n,v,c))}};t.SkeletonJson.readCurve=function(n,t,i){var r=i.curve;r&&(r=="stepped"?n.curves.setStepped(t):r instanceof Array&&n.curves.setCurve(t,r[0],r[1],r[2],r[3]))};t.SkeletonJson.toColor=function(n,t){if(n.length!=8)throw"Color hexidecimal length must be 8, recieved: "+n;return parseInt(n.substring(t*2,2),16)/255};t.Atlas=function(n,i){var e,r,u,o,c,f,s,h,l,a;for(this.textureLoader=i,this.pages=[],this.regions=[],e=new t.AtlasReader(n),r=[],r.length=4,u=null;;){if(o=e.readLine(),o==null)break;o=e.trim(o);o.length?u?(f=new t.AtlasRegion,f.name=o,f.page=u,f.rotate=e.readValue()=="true",e.readTuple(r),s=parseInt(r[0],10),h=parseInt(r[1],10),e.readTuple(r),l=parseInt(r[0],10),a=parseInt(r[1],10),f.u=s/u.width,f.v=h/u.height,f.rotate?(f.u2=(s+a)/u.width,f.v2=(h+l)/u.height):(f.u2=(s+l)/u.width,f.v2=(h+a)/u.height),f.x=s,f.y=h,f.width=Math.abs(l),f.height=Math.abs(a),e.readTuple(r)==4&&(f.splits=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10)],e.readTuple(r)==4&&(f.pads=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10)],e.readTuple(r))),f.originalWidth=parseInt(r[0],10),f.originalHeight=parseInt(r[1],10),e.readTuple(r),f.offsetX=parseInt(r[0],10),f.offsetY=parseInt(r[1],10),f.index=parseInt(e.readValue(),10),this.regions.push(f)):(u=new t.AtlasPage,u.name=o,u.format=t.Atlas.Format[e.readValue()],e.readTuple(r),u.minFilter=t.Atlas.TextureFilter[r[0]],u.magFilter=t.Atlas.TextureFilter[r[1]],c=e.readValue(),u.uWrap=t.Atlas.TextureWrap.clampToEdge,u.vWrap=t.Atlas.TextureWrap.clampToEdge,c=="x"?u.uWrap=t.Atlas.TextureWrap.repeat:c=="y"?u.vWrap=t.Atlas.TextureWrap.repeat:c=="xy"&&(u.uWrap=u.vWrap=t.Atlas.TextureWrap.repeat),i.load(u,o),this.pages.push(u)):u=null}};t.Atlas.prototype={findRegion:function(n){for(var i=this.regions,t=0,r=i.length;t<r;t++)if(i[t].name==n)return i[t];return null},dispose:function(){for(var t=this.pages,n=0,i=t.length;n<i;n++)this.textureLoader.unload(t[n].rendererObject)},updateUVs:function(n){for(var t,r=this.regions,i=0,u=r.length;i<u;i++)(t=r[i],t.page==n)&&(t.u=t.x/n.width,t.v=t.y/n.height,t.rotate?(t.u2=(t.x+t.height)/n.width,t.v2=(t.y+t.width)/n.height):(t.u2=(t.x+t.width)/n.width,t.v2=(t.y+t.height)/n.height))}};t.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};t.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};t.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};t.AtlasPage=function(){};t.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};t.AtlasRegion=function(){};t.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};t.AtlasReader=function(n){this.lines=n.split(/\r\n|\r|\n/)};t.AtlasReader.prototype={index:0,trim:function(n){return n.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var n=this.readLine(),t=n.indexOf(":");if(t==-1)throw"Invalid line: "+n;return this.trim(n.substring(t+1))},readTuple:function(n){var i=this.readLine(),f=i.indexOf(":"),t,r,u;if(f==-1)throw"Invalid line: "+i;for(t=0,r=f+1;t<3;t++){if(u=i.indexOf(",",r),u==-1){if(!t)throw"Invalid line: "+i;break}n[t]=this.trim(i.substr(r,u-r));r=u+1}return n[t]=this.trim(i.substring(r)),t+1}};t.AtlasAttachmentLoader=function(n){this.atlas=n};t.AtlasAttachmentLoader.prototype={newAttachment:function(n,i,r){var u,f;switch(i){case t.AttachmentType.region:if(u=this.atlas.findRegion(r),!u)throw"Region not found in atlas: "+r+" ("+i+")";return f=new t.RegionAttachment(r),f.rendererObject=u,f.setUVs(u.u,u.v,u.u2,u.v2,u.rotate),f.regionOffsetX=u.offsetX,f.regionOffsetY=u.offsetY,f.regionWidth=u.width,f.regionHeight=u.height,f.regionOriginalWidth=u.originalWidth,f.regionOriginalHeight=u.originalHeight,f}throw"Unknown attachment type: "+i;}};t.Bone.yDown=!0;n.AnimCache={};n.Spine=function(i){var r,s,h,o;if(n.DisplayObjectContainer.call(this),this.spineData=n.AnimCache[i],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+i);for(this.skeleton=new t.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new t.AnimationStateData(this.spineData),this.state=new t.AnimationState(this.stateData),this.slotContainers=[],r=0,s=this.skeleton.drawOrder.length;r<s;r++){var u=this.skeleton.drawOrder[r],f=u.attachment,e=new n.DisplayObjectContainer;(this.slotContainers.push(e),this.addChild(e),f instanceof t.RegionAttachment)&&(h=f.rendererObject.name,o=this.createSprite(u,f.rendererObject),u.currentSprite=o,u.currentSpriteName=h,e.addChild(o))}};n.Spine.prototype=Object.create(n.DisplayObjectContainer.prototype);n.Spine.prototype.constructor=n.Spine;n.Spine.prototype.updateTransform=function(){var h,s,e,c,o,l,u;for(this.lastTime=this.lastTime||Date.now(),h=(Date.now()-this.lastTime)*.001,this.lastTime=Date.now(),this.state.update(h),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform(),s=this.skeleton.drawOrder,e=0,c=s.length;e<c;e++){var i=s[e],r=i.attachment,f=this.slotContainers[e];if(!(r instanceof t.RegionAttachment)){f.visible=!1;continue}r.rendererObject&&(i.currentSpriteName&&i.currentSpriteName==r.name||(o=r.rendererObject.name,i.currentSprite!==undefined&&(i.currentSprite.visible=!1),i.sprites=i.sprites||{},i.sprites[o]!==undefined?i.sprites[o].visible=!0:(l=this.createSprite(i,r.rendererObject),f.addChild(l)),i.currentSprite=i.sprites[o],i.currentSpriteName=o));f.visible=!0;u=i.bone;f.position.x=u.worldX+r.x*u.m00+r.y*u.m01;f.position.y=u.worldY+r.x*u.m10+r.y*u.m11;f.scale.x=u.worldScaleX;f.scale.y=u.worldScaleY;f.rotation=-(i.bone.worldRotation*Math.PI/180)}n.DisplayObjectContainer.prototype.updateTransform.call(this)};n.Spine.prototype.createSprite=function(t,i){var u=n.TextureCache[i.name]?i.name:i.name+".png",r=new n.Sprite(n.Texture.fromFrame(u));return r.scale=i.scale,r.rotation=i.rotation,r.anchor.x=r.anchor.y=.5,t.sprites=t.sprites||{},t.sprites[i.name]=r,r};n.BaseTextureCache={};n.texturesToUpdate=[];n.texturesToDestroy=[];n.BaseTexture=function(t,i){if(n.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=i||n.BaseTexture.SCALE_MODE.DEFAULT,this.hasLoaded=!1,this.source=t,t){if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,n.texturesToUpdate.push(this);else{var r=this;this.source.onload=function(){r.hasLoaded=!0;r.width=r.source.width;r.height=r.source.height;n.texturesToUpdate.push(r);r.dispatchEvent({type:"loaded",content:r})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,n.texturesToUpdate.push(this);this.imageUrl=null;this._powerOf2=!1;this._glTextures=[]}};n.BaseTexture.prototype.constructor=n.BaseTexture;n.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.imageUrl in n.BaseTextureCache&&delete n.BaseTextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null);this.source=null;n.texturesToDestroy.push(this)};n.BaseTexture.prototype.updateSourceImage=function(n){this.hasLoaded=!1;this.source.src=null;this.source.src=n};n.BaseTexture.fromImage=function(t,i,r){var u=n.BaseTextureCache[t],f;return u||(f=new Image,i&&(f.crossOrigin=""),f.src=t,u=new n.BaseTexture(f,r),u.imageUrl=t,n.BaseTextureCache[t]=u),u};n.BaseTexture.SCALE_MODE={DEFAULT:0,LINEAR:0,NEAREST:1};n.TextureCache={};n.FrameCache={};n.Texture=function(t,i){if(n.EventTarget.call(this),i||(this.noFrame=!0,i=new n.Rectangle(0,0,1,1)),t instanceof n.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=i,this.trim=new n.Point,this.scope=this,t.hasLoaded)this.noFrame&&(i=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(i);else{var r=this;t.addEventListener("loaded",function(){r.onBaseTextureLoaded()})}};n.Texture.prototype.constructor=n.Texture;n.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded);this.noFrame&&(this.frame=new n.Rectangle(0,0,t.width,t.height));this.setFrame(this.frame);this.scope.dispatchEvent({type:"update",content:this})};n.Texture.prototype.destroy=function(n){n&&this.baseTexture.destroy()};n.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0;n.Texture.frameUpdates.push(this)};n.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new Float32Array(8));var n=this.frame,t=this.baseTexture.width,i=this.baseTexture.height;this._uvs[0]=n.x/t;this._uvs[1]=n.y/i;this._uvs[2]=(n.x+n.width)/t;this._uvs[3]=n.y/i;this._uvs[4]=(n.x+n.width)/t;this._uvs[5]=(n.y+n.height)/i;this._uvs[6]=n.x/t;this._uvs[7]=(n.y+n.height)/i};n.Texture.fromImage=function(t,i,r){var u=n.TextureCache[t];return u||(u=new n.Texture(n.BaseTexture.fromImage(t,i,r)),n.TextureCache[t]=u),u};n.Texture.fromFrame=function(t){var i=n.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return i};n.Texture.fromCanvas=function(t,i){var r=new n.BaseTexture(t,i);return new n.Texture(r)};n.Texture.addTextureToCache=function(t,i){n.TextureCache[i]=t};n.Texture.removeTextureFromCache=function(t){var i=n.TextureCache[t];return n.TextureCache[t]=null,i};n.Texture.frameUpdates=[];n.Texture.SCALE_MODE=n.BaseTexture.SCALE_MODE;n.RenderTexture=function(t,i,r){if(n.EventTarget.call(this),this.width=t||100,this.height=i||100,this.indetityMatrix=n.mat3.create(),this.frame=new n.Rectangle(0,0,this.width,this.height),this.baseTexture=new n.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.hasLoaded=!0,this.renderer=r||n.defaultRenderer,this.renderer.type===n.WEBGL_RENDERER){var u=this.renderer.gl;this.textureBuffer=new n.FilterTexture(u,this.width,this.height);this.baseTexture._glTextures[u.id]=this.textureBuffer.texture;this.render=this.renderWebGL;this.projection=new n.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new n.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;n.Texture.frameUpdates.push(this)};n.RenderTexture.prototype=Object.create(n.Texture.prototype);n.RenderTexture.prototype.constructor=n.RenderTexture;n.RenderTexture.prototype.resize=function(t,i){if(this.width=t,this.height=i,this.frame.width=this.width,this.frame.height=this.height,this.renderer.type===n.WEBGL_RENDERER){this.projection.x=this.width/2;this.projection.y=-this.height/2;var r=this.gl;r.bindTexture(r.TEXTURE_2D,this.baseTexture._glTextures[r.id]);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null)}else this.textureBuffer.resize(this.width,this.height);n.Texture.frameUpdates.push(this)};n.RenderTexture.prototype.renderWebGL=function(t,i,r){var u=this.renderer.gl,e,o,f,s;for(u.colorMask(!0,!0,!0,!0),u.viewport(0,0,this.width,this.height),u.bindFramebuffer(u.FRAMEBUFFER,this.textureBuffer.frameBuffer),r&&this.textureBuffer.clear(),e=t.children,o=t.worldTransform,t.worldTransform=n.mat3.create(),t.worldTransform[4]=-1,t.worldTransform[5]=this.projection.y*-2,i&&(t.worldTransform[2]=i.x,t.worldTransform[5]-=i.y),n.visibleCount++,t.vcount=n.visibleCount,f=0,s=e.length;f<s;f++)e[f].updateTransform();this.renderer.renderDisplayObject(t,this.projection);t.worldTransform=o};n.RenderTexture.prototype.renderCanvas=function(t,i,r){var e=t.children,u,o,f;for(t.worldTransform=n.mat3.create(),i&&(t.worldTransform[2]=i.x,t.worldTransform[5]=i.y),u=0,o=e.length;u<o;u++)e[u].updateTransform();r&&this.textureBuffer.clear();f=this.textureBuffer.context;this.renderer.renderDisplayObject(t,f);f.setTransform(1,0,0,1,0,0)};n.AssetLoader=function(t,i){n.EventTarget.call(this);this.assetURLs=t;this.crossorigin=i;this.loadersByType={jpg:n.ImageLoader,jpeg:n.ImageLoader,png:n.ImageLoader,gif:n.ImageLoader,json:n.JsonLoader,atlas:n.AtlasLoader,anim:n.SpineLoader,xml:n.BitmapFontLoader,fnt:n.BitmapFontLoader}};n.AssetLoader.prototype.constructor=n.AssetLoader;n.AssetLoader.prototype._getDataType=function(n){var i="data:",f=n.slice(0,i.length).toLowerCase(),r,u,t;return f===i?(r=n.slice(i.length),u=r.indexOf(","),u===-1)?null:(t=r.slice(0,u).split(";")[0],!t||t.toLowerCase()==="text/plain")?"txt":t.split("/").pop().toLowerCase():null};n.AssetLoader.prototype.load=function(){function e(){f.onAssetLoaded()}var f=this,t,i,n,r,u;for(this.loadCount=this.assetURLs.length,t=0;t<this.assetURLs.length;t++){if(i=this.assetURLs[t],n=this._getDataType(i),n||(n=i.split("?").shift().split(".").pop().toLowerCase()),r=this.loadersByType[n],!r)throw new Error(n+" is an unsupported file type");u=new r(i,this.crossorigin);u.addEventListener("loaded",e);u.load()}};n.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--;this.dispatchEvent({type:"onProgress",content:this});this.onProgress&&this.onProgress();this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())};n.JsonLoader=function(t,i){n.EventTarget.call(this);this.url=t;this.crossorigin=i;this.baseUrl=t.replace(/[^\/]*$/,"");this.loaded=!1};n.JsonLoader.prototype.constructor=n.JsonLoader;n.JsonLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onJSONLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};n.JsonLoader.prototype.onJSONLoaded=function(){var i,r,u,o,s,h,c;if(this.ajaxRequest.readyState===4)if(this.ajaxRequest.status===200||window.location.protocol.indexOf("http")===-1)if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var l=this,a=this.baseUrl+this.json.meta.image,e=new n.ImageLoader(a,this.crossorigin),f=this.json.frames;this.texture=e.texture.baseTexture;e.addEventListener("loaded",function(){l.onLoaded()});for(i in f)r=f[i].frame,r&&(n.TextureCache[i]=new n.Texture(this.texture,{x:r.x,y:r.y,width:r.w,height:r.h}),f[i].trimmed&&(u=n.TextureCache[i],u.trimmed=!0,o=f[i].sourceSize,s=f[i].spriteSourceSize,u.trim.x=s.x,u.trim.y=s.y,u.trim.realWidth=o.w,u.trim.realHeight=o.h));e.load()}else this.json.bones?(h=new t.SkeletonJson,c=h.readSkeletonData(this.json),n.AnimCache[this.url]=c,this.onLoaded()):this.onLoaded();else this.onError()};n.JsonLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};n.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};n.AtlasLoader=function(t,i){n.EventTarget.call(this);this.url=t;this.baseUrl=t.replace(/[^\/]*$/,"");this.crossorigin=i;this.loaded=!1};n.AtlasLoader.constructor=n.AtlasLoader;n.AtlasLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this);this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};n.AtlasLoader.prototype.onAtlasLoaded=function(){var e,h,a,s,o;if(this.ajaxRequest.readyState===4)if(this.ajaxRequest.status===200||window.location.href.indexOf("http")===-1){this.atlas={meta:{image:[]},frames:[]};for(var u=this.ajaxRequest.responseText.split(/\r?\n/),f=-3,c=0,i=null,l=!1,t=0,r=0,v=this.onLoaded.bind(this),t=0;t<u.length;t++)u[t]=u[t].replace(/^\s+|\s+$/g,""),u[t]===""&&(l=t+1),u[t].length>0&&(l===t?(this.atlas.meta.image.push(u[t]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),f=-3):f>0&&(f%7==1?(i!=null&&(this.atlas.frames[c][i.name]=i),i={name:u[t],frame:{}}):(e=u[t].split(" "),f%7==3?(i.frame.x=Number(e[1].replace(",","")),i.frame.y=Number(e[2])):f%7==4?(i.frame.w=Number(e[1].replace(",","")),i.frame.h=Number(e[2])):f%7==5&&(h={x:0,y:0,w:Number(e[1].replace(",","")),h:Number(e[2])},h.w>i.frame.w||h.h>i.frame.h?(i.trimmed=!0,i.realSize=h):i.trimmed=!1))),f++);if(i!=null&&(this.atlas.frames[c][i.name]=i),this.atlas.meta.image.length>0){for(this.images=[],r=0;r<this.atlas.meta.image.length;r++){a=this.baseUrl+this.atlas.meta.image[r];s=this.atlas.frames[r];this.images.push(new n.ImageLoader(a,this.crossorigin));for(t in s)o=s[t].frame,o&&(n.TextureCache[t]=new n.Texture(this.images[r].texture.baseTexture,{x:o.x,y:o.y,width:o.w,height:o.h}),s[t].trimmed&&(n.TextureCache[t].realSize=s[t].realSize,n.TextureCache[t].trim.x=0,n.TextureCache[t].trim.y=0))}for(this.currentImageId=0,r=0;r<this.images.length;r++)this.images[r].addEventListener("loaded",v);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()};n.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))};n.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};n.SpriteSheetLoader=function(t,i){n.EventTarget.call(this);this.url=t;this.crossorigin=i;this.baseUrl=t.replace(/[^\/]*$/,"");this.texture=null;this.frames={}};n.SpriteSheetLoader.prototype.constructor=n.SpriteSheetLoader;n.SpriteSheetLoader.prototype.load=function(){var t=this,i=new n.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(n){t.json=n.content.json;t.onJSONLoaded()});i.load()};n.SpriteSheetLoader.prototype.onJSONLoaded=function(){var f=this,e=this.baseUrl+this.json.meta.image,u=new n.ImageLoader(e,this.crossorigin),r=this.json.frames,t,i;this.texture=u.texture.baseTexture;u.addEventListener("loaded",function(){f.onLoaded()});for(t in r)i=r[t].frame,i&&(n.TextureCache[t]=new n.Texture(this.texture,{x:i.x,y:i.y,width:i.w,height:i.h}),r[t].trimmed&&(n.TextureCache[t].realSize=r[t].spriteSourceSize,n.TextureCache[t].trim.x=0));u.load()};n.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};n.ImageLoader=function(t,i){n.EventTarget.call(this);this.texture=n.Texture.fromImage(t,i);this.frames=[]};n.ImageLoader.prototype.constructor=n.ImageLoader;n.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var n=this;this.texture.baseTexture.addEventListener("loaded",function(){n.onLoaded()})}};n.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};n.ImageLoader.prototype.loadFramedSpriteSheet=function(t,i,r){var u,f,e,s;this.frames=[];var h=Math.floor(this.texture.width/t),c=Math.floor(this.texture.height/i),o=0;for(u=0;u<c;u++)for(f=0;f<h;f++,o++)e=new n.Texture(this.texture,{x:f*t,y:u*i,width:t,height:i}),this.frames.push(e),r&&(n.TextureCache[r+"-"+o]=e);this.texture.baseTexture.hasLoaded?this.onLoaded():(s=this,this.texture.baseTexture.addEventListener("loaded",function(){s.onLoaded()}))};n.BitmapFontLoader=function(t,i){n.EventTarget.call(this);this.url=t;this.crossorigin=i;this.baseUrl=t.replace(/[^\/]*$/,"");this.texture=null};n.BitmapFontLoader.prototype.constructor=n.BitmapFontLoader;n.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var n=this;this.ajaxRequest.onreadystatechange=function(){n.onXMLLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml");this.ajaxRequest.send(null)};n.BitmapFontLoader.prototype.onXMLLoaded=function(){var o,f,i,t,e,h,u,c;if(this.ajaxRequest.readyState===4&&(this.ajaxRequest.status===200||window.location.protocol.indexOf("http")===-1)){o=this.baseUrl+this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue;f=new n.ImageLoader(o,this.crossorigin);this.texture=f.texture.baseTexture;var r={},s=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],l=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];for(r.font=s.attributes.getNamedItem("face").nodeValue,r.size=parseInt(s.attributes.getNamedItem("size").nodeValue,10),r.lineHeight=parseInt(l.attributes.getNamedItem("lineHeight").nodeValue,10),r.chars={},i=this.ajaxRequest.responseXML.getElementsByTagName("char"),t=0;t<i.length;t++)e=parseInt(i[t].attributes.getNamedItem("id").nodeValue,10),h=new n.Rectangle(parseInt(i[t].attributes.getNamedItem("x").nodeValue,10),parseInt(i[t].attributes.getNamedItem("y").nodeValue,10),parseInt(i[t].attributes.getNamedItem("width").nodeValue,10),parseInt(i[t].attributes.getNamedItem("height").nodeValue,10)),r.chars[e]={xOffset:parseInt(i[t].attributes.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(i[t].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(i[t].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:n.TextureCache[e]=new n.Texture(this.texture,h)};for(u=this.ajaxRequest.responseXML.getElementsByTagName("kerning"),t=0;t<u.length;t++){var a=parseInt(u[t].attributes.getNamedItem("first").nodeValue,10),v=parseInt(u[t].attributes.getNamedItem("second").nodeValue,10),y=parseInt(u[t].attributes.getNamedItem("amount").nodeValue,10);r.chars[v].kerning[a]=y}n.BitmapText.fonts[r.font]=r;c=this;f.addEventListener("loaded",function(){c.onLoaded()});f.load()}};n.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};n.SpineLoader=function(t,i){n.EventTarget.call(this);this.url=t;this.crossorigin=i;this.loaded=!1};n.SpineLoader.prototype.constructor=n.SpineLoader;n.SpineLoader.prototype.load=function(){var t=this,i=new n.JsonLoader(this.url,this.crossorigin);i.addEventListener("loaded",function(n){t.json=n.content.json;t.onJSONLoaded()});i.load()};n.SpineLoader.prototype.onJSONLoaded=function(){var i=new t.SkeletonJson,r=i.readSkeletonData(this.json);n.AnimCache[this.url]=r;this.onLoaded()};n.SpineLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};n.AbstractFilter=function(n,t){this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.uniforms=t||{};this.fragmentSrc=n||[]};n.ColorMatrixFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]};n.ColorMatrixFilter.prototype=Object.create(n.AbstractFilter.prototype);n.ColorMatrixFilter.prototype.constructor=n.ColorMatrixFilter;Object.defineProperty(n.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(n){this.uniforms.matrix.value=n}});n.GrayFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={gray:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]};n.GrayFilter.prototype=Object.create(n.AbstractFilter.prototype);n.GrayFilter.prototype.constructor=n.GrayFilter;Object.defineProperty(n.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(n){this.uniforms.gray.value=n}});n.DisplacementFilter=function(t){if(n.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded)this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height;else{this.boundLoadedFunction=this.onTextureLoaded.bind(this);t.baseTexture.on("loaded",this.boundLoadedFunction)}this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]};n.DisplacementFilter.prototype=Object.create(n.AbstractFilter.prototype);n.DisplacementFilter.prototype.constructor=n.DisplacementFilter;n.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height;this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(n.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(n){this.uniforms.displacementMap.value=n}});Object.defineProperty(n.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(n){this.uniforms.scale.value=n}});Object.defineProperty(n.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(n){this.uniforms.offset.value=n}});n.PixelateFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]};n.PixelateFilter.prototype=Object.create(n.AbstractFilter.prototype);n.PixelateFilter.prototype.constructor=n.PixelateFilter;Object.defineProperty(n.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(n){this.dirty=!0;this.uniforms.pixelSize.value=n}});n.BlurXFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]};n.BlurXFilter.prototype=Object.create(n.AbstractFilter.prototype);n.BlurXFilter.prototype.constructor=n.BlurXFilter;Object.defineProperty(n.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.dirty=!0;this.uniforms.blur.value=1/7e3*n}});n.BlurYFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]};n.BlurYFilter.prototype=Object.create(n.AbstractFilter.prototype);n.BlurYFilter.prototype.constructor=n.BlurYFilter;Object.defineProperty(n.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.uniforms.blur.value=1/7e3*n}});n.BlurFilter=function(){this.blurXFilter=new n.BlurXFilter;this.blurYFilter=new n.BlurYFilter;this.passes=[this.blurXFilter,this.blurYFilter]};Object.defineProperty(n.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(n){this.blurXFilter.blur=this.blurYFilter.blur=n}});Object.defineProperty(n.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(n){this.blurXFilter.blur=n}});Object.defineProperty(n.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(n){this.blurYFilter.blur=n}});n.InvertFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]};n.InvertFilter.prototype=Object.create(n.AbstractFilter.prototype);n.InvertFilter.prototype.constructor=n.InvertFilter;Object.defineProperty(n.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(n){this.uniforms.invert.value=n}});n.SepiaFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={sepia:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]};n.SepiaFilter.prototype=Object.create(n.AbstractFilter.prototype);n.SepiaFilter.prototype.constructor=n.SepiaFilter;Object.defineProperty(n.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(n){this.uniforms.sepia.value=n}});n.TwistFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]};n.TwistFilter.prototype=Object.create(n.AbstractFilter.prototype);n.TwistFilter.prototype.constructor=n.TwistFilter;Object.defineProperty(n.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(n){this.dirty=!0;this.uniforms.offset.value=n}});Object.defineProperty(n.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(n){this.dirty=!0;this.uniforms.radius.value=n}});Object.defineProperty(n.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(n){this.dirty=!0;this.uniforms.angle.value=n}});n.ColorStepFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={step:{type:"1f",value:5}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]};n.ColorStepFilter.prototype=Object.create(n.AbstractFilter.prototype);n.ColorStepFilter.prototype.constructor=n.ColorStepFilter;Object.defineProperty(n.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(n){this.uniforms.step.value=n}});n.DotScreenFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]};n.DotScreenFilter.prototype=Object.create(n.DotScreenFilter.prototype);n.DotScreenFilter.prototype.constructor=n.DotScreenFilter;Object.defineProperty(n.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(n){this.dirty=!0;this.uniforms.scale.value=n}});Object.defineProperty(n.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(n){this.dirty=!0;this.uniforms.angle.value=n}});n.CrossHatchFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]};n.CrossHatchFilter.prototype=Object.create(n.AbstractFilter.prototype);n.CrossHatchFilter.prototype.constructor=n.BlurYFilter;Object.defineProperty(n.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.uniforms.blur.value=1/7e3*n}});n.RGBSplitFilter=function(){n.AbstractFilter.call(this);this.passes=[this];this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]};n.RGBSplitFilter.prototype=Object.create(n.AbstractFilter.prototype);n.RGBSplitFilter.prototype.constructor=n.RGBSplitFilter;Object.defineProperty(n.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(n){this.uniforms.blur.value=1/7e3*n}});typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports.PIXI=n):typeof define!="undefined"&&define.amd?define(n):e.PIXI=n}).call(this);
//# sourceMappingURL=pixi-1.4.1.min.js.map